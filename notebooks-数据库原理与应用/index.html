<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.6.2" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.6.2" type="image/png" sizes="32x32"><meta name="description" content="数据库课堂随堂笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="数据库原理与应用随堂笔记">
<meta property="og:url" content="http://blog.gddfeng.com/notebooks-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/index.html">
<meta property="og:site_name" content="孤独的風">
<meta property="og:description" content="数据库课堂随堂笔记">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-09-26T08:40:16.000Z">
<meta property="article:modified_time" content="2021-11-08T08:40:40.000Z">
<meta property="article:author" content="gddFeng">
<meta property="article:tag" content="课堂笔记">
<meta property="article:tag" content="数据库">
<meta name="twitter:card" content="summary"><title>数据库原理与应用随堂笔记 | 孤独的風</title><link ref="canonical" href="http://blog.gddfeng.com/notebooks-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.6.2"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":false,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"carbon","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"复制","copySuccess":"复制成功","copyError":"复制失败"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 5.4.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner header-inner--height header-inner--bgcolor"><nav class="header-nav header-nav--sticky"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">首页</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/课堂笔记/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">课堂笔记</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="javascript:;" onclick="return false;"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">编程语言</span></a><div class="header-nav-submenu"><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/categories/编程语言/c/"><span class="header-nav-submenu-item__text">C++</span></a></div><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/categories/编程语言/蓝桥/"><span class="header-nav-submenu-item__text">蓝桥</span></a></div></div></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="javascript:;" onclick="return false;"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">考研学习</span></a><div class="header-nav-submenu"><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/categories/考研学习/计算机网络/"><span class="header-nav-submenu-item__text">计算机网络</span></a></div><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/categories/考研学习/计算机操作系统/"><span class="header-nav-submenu-item__text">计算机操作系统</span></a></div></div></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="javascript:;" onclick="return false;"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">渗透测试</span></a><div class="header-nav-submenu"><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/categories/渗透测试/SQL注入/"><span class="header-nav-submenu-item__text">SQL注入</span></a></div></div></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">归档</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">分类</span></a></div></div><div class="header-nav-search"><span class="header-nav-search__icon"><i class="fas fa-search"></i></span><span class="header-nav-search__text">搜索</span></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">数据库原理与应用随堂笔记</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-09-26</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2021-11-08</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">18.5k</span></span><span class="post-meta-item post-meta-item--readtime"><span class="post-meta-item__icon"><i class="far fa-clock"></i></span><span class="post-meta-item__info">阅读时长</span><span class="post-meta-item__value">132分</span></span></div></header><div class="post-body">
        <h1 id="第1课-介绍"   >
          <a href="#第1课-介绍" class="heading-link"><i class="fas fa-link"></i></a><a href="#第1课-介绍" class="headerlink" title="第1课 介绍"></a>第1课 介绍</h1>
      
        <h2 id="1-1-数据库结构"   >
          <a href="#1-1-数据库结构" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-1-数据库结构" class="headerlink" title="1.1 数据库结构"></a>1.1 数据库结构</h2>
      <p>DBMS-&gt;DB-&gt;Table-&gt;Column-&gt;Data   </p>
<p>数据库管理系统-&gt;数据库-&gt;表-&gt;列-&gt;字段    </p>

        <h2 id="1-2-课程设计"   >
          <a href="#1-2-课程设计" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-2-课程设计" class="headerlink" title="1.2 课程设计"></a>1.2 课程设计</h2>
      <ol>
<li>认识数据库及概述</li>
<li>数据库的创建与管理</li>
<li>创建与管理数据表<ul>
<li>掌握表结构的创建、修改和查询，掌握添加、修改和删除表中的数据和完整性约束的实现。</li>
</ul>
</li>
<li>数据查询<ul>
<li>掌握基本查询、连接查询、数据汇总的使用，熟悉嵌套查询的使用。</li>
</ul>
</li>
<li>视图的创建与使用</li>
<li>MySQL编程</li>
<li>数据库规划与设计<ul>
<li>掌握数据库设计的步骤，并了解范式对数据库设计进行判定并规范</li>
</ul>
</li>
</ol>

        <h2 id="1-3-SQL-server体验"   >
          <a href="#1-3-SQL-server体验" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-3-SQL-server体验" class="headerlink" title="1.3 SQL server体验"></a>1.3 SQL server体验</h2>
      
        <h3 id="1-3-1-使用工具登录SQL-server"   >
          <a href="#1-3-1-使用工具登录SQL-server" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-3-1-使用工具登录SQL-server" class="headerlink" title="1.3.1 使用工具登录SQL server"></a>1.3.1 使用工具登录SQL server</h3>
      <p>服务器名就是电脑设备名</p>
<ul>
<li>Windows身份验证<ul>
<li>直接连接就可以</li>
</ul>
</li>
<li>SQL server身份验证<ul>
<li>通常都是用户名是<code>sa</code>,密码是<code>123456</code>。     </li>
</ul>
</li>
</ul>
<p>忘记了密码可以通过Windows身份登录，双击<code>安全性下登录名下的sa</code>就可以修改密码</p>

        <h3 id="1-3-2-使用脚本"   >
          <a href="#1-3-2-使用脚本" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-3-2-使用脚本" class="headerlink" title="1.3.2 使用脚本"></a>1.3.2 使用脚本</h3>
      <figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/****** 对象:  Database [xkgl]   </span></span><br><span class="line"><span class="comment"> 脚本日期: 04/05/2012 14:43:32 ******/</span></span><br><span class="line"><span class="keyword">CREATE</span> DATABASE xkgl     </span><br><span class="line">go</span><br><span class="line"><span class="comment">/*创建xkgl数据库*/</span></span><br><span class="line">use xkgl        </span><br><span class="line">GO </span><br><span class="line"><span class="comment">/*使用xkgl数据库*/</span></span><br><span class="line">if <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dbo.sysobjects <span class="keyword">where</span> id <span class="operator">=</span> object_id(N<span class="string">&#x27;[dbo].[Department]&#x27;</span>) <span class="keyword">and</span> OBJECTPROPERTY(id, N<span class="string">&#x27;IsUserTable&#x27;</span>) <span class="operator">=</span> <span class="number">1</span>) <span class="keyword">drop</span> <span class="keyword">table</span> [dbo].[Department]</span><br><span class="line">GO</span><br><span class="line"><span class="comment">--表 Department 的结构</span></span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> Department(</span><br><span class="line">DepartmentID <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">primary</span> key,</span><br><span class="line"><span class="comment">/*创立DepartmentID为主键，主键是唯一的*/</span></span><br><span class="line">DepartmentName <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">unique</span>,</span><br><span class="line">DepartmentHeader <span class="type">varchar</span>(<span class="number">8</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">TeacherNum <span class="type">int</span> </span><br><span class="line">)</span><br><span class="line">GO</span><br><span class="line"><span class="comment">--表 Department 的数据</span></span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Department([DepartmentID],[DepartmentName],[DepartmentHeader],[TeacherNum]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp01&#x27;</span>,<span class="string">&#x27;计算机系&#x27;</span>,<span class="string">&#x27;罗浩然&#x27;</span>,<span class="number">120</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Department([DepartmentID],[DepartmentName],[DepartmentHeader],[TeacherNum]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp02&#x27;</span>,<span class="string">&#x27;信管系&#x27;</span>,<span class="string">&#x27;李伶俐&#x27;</span>,<span class="keyword">null</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Department([DepartmentID],[DepartmentName],[DepartmentHeader],[TeacherNum]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp03&#x27;</span>,<span class="string">&#x27;英语系&#x27;</span>,<span class="string">&#x27;李宏伟&#x27;</span>,<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dbo.sysobjects <span class="keyword">where</span> id <span class="operator">=</span> object_id(N<span class="string">&#x27;[dbo].[Class]&#x27;</span>) <span class="keyword">and</span> OBJECTPROPERTY(id, N<span class="string">&#x27;IsUserTable&#x27;</span>) <span class="operator">=</span> <span class="number">1</span>) <span class="keyword">drop</span> <span class="keyword">table</span> [dbo].[Class]</span><br><span class="line">GO</span><br><span class="line"><span class="comment">--表 Class 的结构</span></span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> Class(</span><br><span class="line">ClassID   <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">primary</span> key,</span><br><span class="line">ClassName <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">Monitor  <span class="type">char</span>(<span class="number">8</span>),</span><br><span class="line">StudentNum <span class="type">int</span> <span class="keyword">check</span>(StudentNum<span class="operator">&gt;</span><span class="number">0</span>),</span><br><span class="line">DepartmentID <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">references</span> Department(DepartmentID)</span><br><span class="line">)</span><br><span class="line">go</span><br><span class="line"><span class="comment">--表 Class 的数据</span></span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Class([ClassID],[ClassName],[Monitor],[StudentNum],[DepartmentID]) <span class="keyword">Values</span>(<span class="string">&#x27;Cs010901&#x27;</span>,<span class="string">&#x27;09软件技术1班&#x27;</span>,<span class="string">&#x27;方凯&#x27;</span>,<span class="number">34</span>,<span class="string">&#x27;Dp01&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Class([ClassID],[ClassName],[Monitor],[StudentNum],[DepartmentID]) <span class="keyword">Values</span>(<span class="string">&#x27;Cs010902&#x27;</span>,<span class="string">&#x27;09软件测试1班&#x27;</span>,<span class="string">&#x27;林静&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;Dp01&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Class([ClassID],[ClassName],[Monitor],[StudentNum],[DepartmentID]) <span class="keyword">Values</span>(<span class="string">&#x27;Cs010903&#x27;</span>,<span class="string">&#x27;09数据库班&#x27;</span>,<span class="string">&#x27;黄勇&#x27;</span>,<span class="number">28</span>,<span class="string">&#x27;Dp01&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Class([ClassID],[ClassName],[Monitor],[StudentNum],[DepartmentID]) <span class="keyword">Values</span>(<span class="string">&#x27;Cs011104&#x27;</span>,<span class="string">&#x27;11网络工程&#x27;</span>,<span class="keyword">null</span>,<span class="number">23</span>,<span class="string">&#x27;Dp01&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Class([ClassID],[ClassName],[Monitor],[StudentNum],[DepartmentID]) <span class="keyword">Values</span>(<span class="string">&#x27;Cs021001&#x27;</span>,<span class="string">&#x27;10电子商务1班&#x27;</span>,<span class="string">&#x27;李米&#x27;</span>,<span class="number">33</span>,<span class="string">&#x27;Dp02&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Class([ClassID],[ClassName],[Monitor],[StudentNum],[DepartmentID]) <span class="keyword">Values</span>(<span class="string">&#x27;Cs021002&#x27;</span>,<span class="string">&#x27;10电子商务2班&#x27;</span>,<span class="keyword">null</span>,<span class="keyword">null</span>,<span class="string">&#x27;Dp02&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dbo.sysobjects <span class="keyword">where</span> id <span class="operator">=</span> object_id(N<span class="string">&#x27;[dbo].[Student]&#x27;</span>) <span class="keyword">and</span> OBJECTPROPERTY(id, N<span class="string">&#x27;IsUserTable&#x27;</span>) <span class="operator">=</span> <span class="number">1</span>) <span class="keyword">drop</span> <span class="keyword">table</span> [dbo].[Student]</span><br><span class="line">GO</span><br><span class="line"><span class="comment">--表 Student 的结构</span></span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> Student(</span><br><span class="line">StudentID   <span class="type">char</span>(<span class="number">12</span>) <span class="keyword">primary</span> key,</span><br><span class="line">StudentName <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">Sex  <span class="type">char</span>(<span class="number">2</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">check</span>(sex <span class="keyword">in</span>(<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;女&#x27;</span>)),</span><br><span class="line">Birth  datetime <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">HomeAddr <span class="type">varchar</span>(<span class="number">80</span>),</span><br><span class="line">EntranceTime datetime <span class="keyword">default</span> getdate(),</span><br><span class="line">ClassID <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">references</span> Class(ClassID)</span><br><span class="line">)</span><br><span class="line">go</span><br><span class="line"><span class="comment">--表 Student 的数据</span></span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0109010001&#x27;</span>,<span class="string">&#x27;张宏    &#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;1998-4-4&#x27;</span>,<span class="string">&#x27;广州市天河区常保阁东 80 号&#x27;</span>,<span class="string">&#x27;2016-9-10&#x27;</span>,<span class="string">&#x27;Cs010901&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0109010002&#x27;</span>,<span class="string">&#x27;姜明凡  &#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;1997-12-7&#x27;</span>,<span class="string">&#x27;汕头市天源路34号&#x27;</span>,<span class="string">&#x27;2016-9-19&#x27;</span>,<span class="string">&#x27;Cs010901&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0109010003&#x27;</span>,<span class="string">&#x27;张丽    &#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1997-9-30&#x27;</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;2016-9-19&#x27;</span>,<span class="string">&#x27;Cs010901&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0109010004&#x27;</span>,<span class="string">&#x27;赵新宇  &#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;1998-5-9&#x27;</span>,<span class="string">&#x27;大连市沙河区承德西路 80 号&#x27;</span>,<span class="string">&#x27;2016-9-10&#x27;</span>,<span class="string">&#x27;Cs010901&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0109010005&#x27;</span>,<span class="string">&#x27;李宇凯  &#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;1996-11-27&#x27;</span>,<span class="string">&#x27;大连市沙河区花园东街 90 号&#x27;</span>,<span class="string">&#x27;2016-9-10&#x27;</span>,<span class="string">&#x27;Cs010901&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0109010006&#x27;</span>,<span class="string">&#x27;黄丽莉  &#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1997-8-15&#x27;</span>,<span class="string">&#x27;佛山市南海区南海大道120号&#x27;</span>,<span class="string">&#x27;2016-9-10&#x27;</span>,<span class="string">&#x27;Cs010901&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0109010007&#x27;</span>,<span class="string">&#x27;胡雨樱  &#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1997-6-23&#x27;</span>,<span class="string">&#x27;佛山市南海区狮山20号&#x27;</span>,<span class="string">&#x27;2016-9-10&#x27;</span>,<span class="string">&#x27;Cs010901&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0109010008&#x27;</span>,<span class="string">&#x27;曹海华  &#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;1999-7-12&#x27;</span>,<span class="string">&#x27;上海市黄石路 50 号&#x27;</span>,<span class="string">&#x27;2016-9-10&#x27;</span>,<span class="string">&#x27;Cs010901&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0109010009&#x27;</span>,<span class="string">&#x27;许田    &#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;1998-2-21&#x27;</span>,<span class="string">&#x27;深圳市福田区福华路29号京海大厦18c&#x27;</span>,<span class="string">&#x27;2016-9-10&#x27;</span>,<span class="string">&#x27;Cs010901&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0109020001&#x27;</span>,<span class="string">&#x27;李平    &#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;1998-4-30&#x27;</span>,<span class="string">&#x27;成都市都江堰红石路321号&#x27;</span>,<span class="string">&#x27;2016-9-10&#x27;</span>,<span class="string">&#x27;Cs010902&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0109020002&#x27;</span>,<span class="string">&#x27;王虎    &#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;1997-10-19&#x27;</span>,<span class="string">&#x27;宜宾市宜宾大道231号&#x27;</span>,<span class="string">&#x27;2016-9-19&#x27;</span>,<span class="string">&#x27;Cs010902&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0109020003&#x27;</span>,<span class="string">&#x27;黄微    &#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1997-7-18&#x27;</span>,<span class="string">&#x27;鞍山市中山大道786号&#x27;</span>,<span class="string">&#x27;2016-9-19&#x27;</span>,<span class="string">&#x27;Cs010902&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0109020004&#x27;</span>,<span class="string">&#x27;张凯芝  &#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1996-5-19&#x27;</span>,<span class="string">&#x27;广州市东山区34号&#x27;</span>,<span class="string">&#x27;2016-9-19&#x27;</span>,<span class="string">&#x27;Cs010902&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0111040001&#x27;</span>,<span class="string">&#x27;立号    &#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;2000-11-4&#x27;</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;2017-9-13&#x27;</span>,<span class="string">&#x27;Cs011104&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0111040002&#x27;</span>,<span class="string">&#x27;姚钱    &#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;2000-4-2&#x27;</span>,<span class="string">&#x27;成都市武侯区中山大道12号&#x27;</span>,<span class="string">&#x27;2011-9-13&#x27;</span>,<span class="string">&#x27;Cs011104&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0111040003&#x27;</span>,<span class="string">&#x27;方雨丽  &#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;2000-10-4&#x27;</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;2017-9-13&#x27;</span>,<span class="string">&#x27;Cs011104&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0210010001&#x27;</span>,<span class="string">&#x27;李平    &#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1999-12-3&#x27;</span>,<span class="string">&#x27;广州市萝岗区32号&#x27;</span>,<span class="string">&#x27;2017-9-12&#x27;</span>,<span class="string">&#x27;Cs021001&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0210010002&#x27;</span>,<span class="string">&#x27;周雅云  &#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1998-4-23&#x27;</span>,<span class="string">&#x27;大连市沙河区花园东街 91 号&#x27;</span>,<span class="string">&#x27;2017-9-12&#x27;</span>,<span class="string">&#x27;Cs021001&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0210010003&#x27;</span>,<span class="string">&#x27;王建伟  &#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;1997-10-10&#x27;</span>,<span class="string">&#x27;成都市中山路321号&#x27;</span>,<span class="string">&#x27;2017-9-12&#x27;</span>,<span class="string">&#x27;Cs021001&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0210010004&#x27;</span>,<span class="string">&#x27;梁冬云  &#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;1998-5-4&#x27;</span>,<span class="string">&#x27;成都市中山路322号&#x27;</span>,<span class="string">&#x27;2010-9-12&#x27;</span>,<span class="string">&#x27;Cs021001&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0210010005&#x27;</span>,<span class="string">&#x27;黄树军  &#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;2000-4-8&#x27;</span>,<span class="string">&#x27;佛山市顺德区五一大道120号&#x27;</span>,<span class="string">&#x27;2017-9-12&#x27;</span>,<span class="string">&#x27;Cs021001&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Student([StudentID],[StudentName],[Sex],[Birth],[HomeAddr],[EntranceTime],[ClassID]) <span class="keyword">Values</span>(<span class="string">&#x27;St0210010006&#x27;</span>,<span class="string">&#x27;雷立    &#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;1999-9-2&#x27;</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;2017-9-12&#x27;</span>,<span class="string">&#x27;Cs021001&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dbo.sysobjects <span class="keyword">where</span> id <span class="operator">=</span> object_id(N<span class="string">&#x27;[dbo].[Course]&#x27;</span>) <span class="keyword">and</span> OBJECTPROPERTY(id, N<span class="string">&#x27;IsUserTable&#x27;</span>) <span class="operator">=</span> <span class="number">1</span>) <span class="keyword">drop</span> <span class="keyword">table</span> [dbo].[Course]</span><br><span class="line">GO</span><br><span class="line"><span class="comment">--表 Course 的结构</span></span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> Course(</span><br><span class="line">CourseID   <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">primary</span> key,</span><br><span class="line">CourseName <span class="type">varchar</span>(<span class="number">60</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">BookNmae  <span class="type">varchar</span>(<span class="number">80</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line"><span class="keyword">period</span> <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">credit <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line">)</span><br><span class="line">go</span><br><span class="line"><span class="comment">--表 Course 的数据</span></span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Course([CourseID],[CourseName],[BookNmae],[<span class="keyword">period</span>],[credit]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010001&#x27;</span>,<span class="string">&#x27;JAVA程序设计&#x27;</span>,<span class="string">&#x27;Java高级程序设计&#x27;</span>,<span class="number">60</span>,<span class="number">4</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Course([CourseID],[CourseName],[BookNmae],[<span class="keyword">period</span>],[credit]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010002&#x27;</span>,<span class="string">&#x27;计算机网络&#x27;</span>,<span class="string">&#x27;计算机网络&#x27;</span>,<span class="number">90</span>,<span class="number">6</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Course([CourseID],[CourseName],[BookNmae],[<span class="keyword">period</span>],[credit]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010003&#x27;</span>,<span class="string">&#x27;数据库原理与应用&#x27;</span>,<span class="string">&#x27;数据库技术与应用-SQL Server 2005&#x27;</span>,<span class="number">60</span>,<span class="number">4</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Course([CourseID],[CourseName],[BookNmae],[<span class="keyword">period</span>],[credit]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;计算机应用基础&#x27;</span>,<span class="string">&#x27;计算机应用基础&#x27;</span>,<span class="number">30</span>,<span class="number">2</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Course([CourseID],[CourseName],[BookNmae],[<span class="keyword">period</span>],[credit]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp020001&#x27;</span>,<span class="string">&#x27;国际贸易实务&#x27;</span>,<span class="string">&#x27;国际贸易实务&#x27;</span>,<span class="number">60</span>,<span class="number">4</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Course([CourseID],[CourseName],[BookNmae],[<span class="keyword">period</span>],[credit]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp020002&#x27;</span>,<span class="string">&#x27;电子商务物流管理&#x27;</span>,<span class="string">&#x27;物流学概论&#x27;</span>,<span class="number">60</span>,<span class="number">4</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Course([CourseID],[CourseName],[BookNmae],[<span class="keyword">period</span>],[credit]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;大学英语(一)&#x27;</span>,<span class="string">&#x27;大学英语综合一&#x27;</span>,<span class="number">90</span>,<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">if <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dbo.sysobjects <span class="keyword">where</span> id <span class="operator">=</span> object_id(N<span class="string">&#x27;[dbo].[Grade]&#x27;</span>) <span class="keyword">and</span> OBJECTPROPERTY(id, N<span class="string">&#x27;IsUserTable&#x27;</span>) <span class="operator">=</span> <span class="number">1</span>) <span class="keyword">drop</span> <span class="keyword">table</span> [dbo].[Grade]</span><br><span class="line">GO</span><br><span class="line"><span class="comment">--表 Grade 的结构</span></span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> Grade(</span><br><span class="line">CourseID   <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">references</span> Course(CourseID),</span><br><span class="line">StudentID <span class="type">char</span>(<span class="number">12</span>) <span class="keyword">references</span> Student(StudentID),</span><br><span class="line">Semester  <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">SchoolYear <span class="type">int</span> ,</span><br><span class="line">Grade <span class="type">numeric</span>(<span class="number">5</span>,<span class="number">1</span>) <span class="keyword">check</span>(grade<span class="operator">&gt;=</span><span class="number">0</span>),</span><br><span class="line"><span class="keyword">primary</span> key(CourseID,StudentID)</span><br><span class="line">)</span><br><span class="line">go</span><br><span class="line"><span class="comment">--表 Grade 的数据</span></span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010001&#x27;</span>,<span class="string">&#x27;St0109010001&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;87&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010001&#x27;</span>,<span class="string">&#x27;St0109010002&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;68&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010001&#x27;</span>,<span class="string">&#x27;St0109010003&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;92&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010001&#x27;</span>,<span class="string">&#x27;St0109010004&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;91&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010001&#x27;</span>,<span class="string">&#x27;St0109010005&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;72&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010001&#x27;</span>,<span class="string">&#x27;St0109010006&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;87&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010001&#x27;</span>,<span class="string">&#x27;St0109010007&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;97&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010001&#x27;</span>,<span class="string">&#x27;St0109010009&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;69&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010001&#x27;</span>,<span class="string">&#x27;St0109020001&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;56&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010001&#x27;</span>,<span class="string">&#x27;St0109020002&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;89&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010001&#x27;</span>,<span class="string">&#x27;St0109020003&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;98&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010001&#x27;</span>,<span class="string">&#x27;St0109020004&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;76&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010001&#x27;</span>,<span class="string">&#x27;St0210010001&#x27;</span>,<span class="number">2</span>,<span class="number">2010</span>,<span class="string">&#x27;88&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010001&#x27;</span>,<span class="string">&#x27;St0210010002&#x27;</span>,<span class="number">2</span>,<span class="number">2010</span>,<span class="string">&#x27;72&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010001&#x27;</span>,<span class="string">&#x27;St0210010003&#x27;</span>,<span class="number">2</span>,<span class="number">2010</span>,<span class="string">&#x27;71&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010002&#x27;</span>,<span class="string">&#x27;St0111040001&#x27;</span>,<span class="number">2</span>,<span class="number">2011</span>,<span class="string">&#x27;54&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010002&#x27;</span>,<span class="string">&#x27;St0111040002&#x27;</span>,<span class="number">2</span>,<span class="number">2011</span>,<span class="string">&#x27;92&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010002&#x27;</span>,<span class="string">&#x27;St0111040003&#x27;</span>,<span class="number">2</span>,<span class="number">2011</span>,<span class="string">&#x27;95&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010003&#x27;</span>,<span class="string">&#x27;St0109010001&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;50&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010003&#x27;</span>,<span class="string">&#x27;St0109010002&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;67&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010003&#x27;</span>,<span class="string">&#x27;St0109010003&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;61&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010003&#x27;</span>,<span class="string">&#x27;St0109010004&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;91&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010003&#x27;</span>,<span class="string">&#x27;St0109010005&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;55&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010003&#x27;</span>,<span class="string">&#x27;St0109010006&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;68&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010003&#x27;</span>,<span class="string">&#x27;St0109010007&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;69&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010003&#x27;</span>,<span class="string">&#x27;St0109010009&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;55&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010003&#x27;</span>,<span class="string">&#x27;St0109020001&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;93&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010003&#x27;</span>,<span class="string">&#x27;St0109020002&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;70&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010003&#x27;</span>,<span class="string">&#x27;St0109020003&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;73&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010003&#x27;</span>,<span class="string">&#x27;St0109020004&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;81&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;St0109010001&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;80&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;St0109010002&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;63&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;St0109010004&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;57&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;St0109010005&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;94&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;St0109010006&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;89&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;St0109010007&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;83&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;St0109010009&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;82&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;St0109020001&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;72&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;St0109020002&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;57&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;St0109020003&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;53&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;St0109020004&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;51&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;St0111040001&#x27;</span>,<span class="number">1</span>,<span class="number">2012</span>,<span class="string">&#x27;55&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;St0111040002&#x27;</span>,<span class="number">1</span>,<span class="number">2012</span>,<span class="string">&#x27;63&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;St0111040003&#x27;</span>,<span class="number">1</span>,<span class="number">2012</span>,<span class="string">&#x27;61&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;St0210010001&#x27;</span>,<span class="number">1</span>,<span class="number">2011</span>,<span class="string">&#x27;99&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;St0210010002&#x27;</span>,<span class="number">1</span>,<span class="number">2011</span>,<span class="string">&#x27;71&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;St0210010003&#x27;</span>,<span class="number">1</span>,<span class="number">2011</span>,<span class="string">&#x27;56&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp020001&#x27;</span>,<span class="string">&#x27;St0210010002&#x27;</span>,<span class="number">2</span>,<span class="number">2010</span>,<span class="string">&#x27;64&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp020001&#x27;</span>,<span class="string">&#x27;St0210010003&#x27;</span>,<span class="number">2</span>,<span class="number">2010</span>,<span class="string">&#x27;82&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp020001&#x27;</span>,<span class="string">&#x27;St0210010004&#x27;</span>,<span class="number">2</span>,<span class="number">2010</span>,<span class="string">&#x27;95&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp020001&#x27;</span>,<span class="string">&#x27;St0210010005&#x27;</span>,<span class="number">2</span>,<span class="number">2010</span>,<span class="string">&#x27;86&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0109010001&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;75&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0109010002&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;53&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0109010003&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;64&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0109010004&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;84&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0109010005&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;72&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0109010006&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;93&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0109010007&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;98&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0109010009&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;64&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0109020001&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;77&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0109020002&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;61&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0109020003&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;63&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0109020004&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>,<span class="string">&#x27;51&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0111040001&#x27;</span>,<span class="number">2</span>,<span class="number">2011</span>,<span class="string">&#x27;96&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0111040002&#x27;</span>,<span class="number">2</span>,<span class="number">2011</span>,<span class="string">&#x27;63&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0111040003&#x27;</span>,<span class="number">2</span>,<span class="number">2011</span>,<span class="string">&#x27;71&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0210010001&#x27;</span>,<span class="number">2</span>,<span class="number">2010</span>,<span class="string">&#x27;77&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0210010002&#x27;</span>,<span class="number">2</span>,<span class="number">2010</span>,<span class="string">&#x27;67&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0210010003&#x27;</span>,<span class="number">2</span>,<span class="number">2010</span>,<span class="string">&#x27;91&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0210010004&#x27;</span>,<span class="number">2</span>,<span class="number">2010</span>,<span class="string">&#x27;68&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Grade([CourseID],[StudentID],[Semester],[SchoolYear],[Grade]) <span class="keyword">Values</span>(<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;St0210010005&#x27;</span>,<span class="number">2</span>,<span class="number">2010</span>,<span class="string">&#x27;73&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dbo.sysobjects <span class="keyword">where</span> id <span class="operator">=</span> object_id(N<span class="string">&#x27;[dbo].[Teacher]&#x27;</span>) <span class="keyword">and</span> OBJECTPROPERTY(id, N<span class="string">&#x27;IsUserTable&#x27;</span>) <span class="operator">=</span> <span class="number">1</span>) <span class="keyword">drop</span> <span class="keyword">table</span> [dbo].[Teacher]</span><br><span class="line">GO</span><br><span class="line"><span class="comment">--表 Teacher 的结构</span></span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> Teacher(</span><br><span class="line">TeacherID   <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">primary</span> key,</span><br><span class="line">Teachername <span class="type">char</span>(<span class="number">12</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">Sex  <span class="type">char</span>(<span class="number">2</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">check</span>(sex <span class="keyword">in</span>(<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;女&#x27;</span>)),</span><br><span class="line">Brith datetime ,</span><br><span class="line">Profession <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">check</span>(profession <span class="keyword">in</span>(<span class="string">&#x27;教授&#x27;</span>,<span class="string">&#x27;副教授&#x27;</span>,<span class="string">&#x27;讲师&#x27;</span>,<span class="string">&#x27;助教&#x27;</span>)),</span><br><span class="line">Telephone <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">HomeAddr <span class="type">varchar</span>(<span class="number">50</span>),</span><br><span class="line">DepartmentID <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">references</span> Department(DepartmentID)</span><br><span class="line">)</span><br><span class="line">go</span><br><span class="line"><span class="comment">--表 Teacher 的数据</span></span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Teacher([TeacherID],[Teachername],[Sex],[Brith],[Profession],[Telephone],[HomeAddr],[DepartmentID]) <span class="keyword">Values</span>(<span class="string">&#x27;dep01001&#x27;</span>,<span class="string">&#x27;王一平      &#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;1968-4-5&#x27;</span>,<span class="string">&#x27;副教授  &#x27;</span>,<span class="string">&#x27;86684567&#x27;</span>,<span class="string">&#x27;东软宿舍29栋309&#x27;</span>,<span class="string">&#x27;Dp01&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Teacher([TeacherID],[Teachername],[Sex],[Brith],[Profession],[Telephone],[HomeAddr],[DepartmentID]) <span class="keyword">Values</span>(<span class="string">&#x27;dep01002&#x27;</span>,<span class="string">&#x27;潘清菊      &#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1976-9-3&#x27;</span>,<span class="string">&#x27;讲师    &#x27;</span>,<span class="string">&#x27;86685633&#x27;</span>,<span class="string">&#x27;东软宿舍21栋109&#x27;</span>,<span class="string">&#x27;Dp01&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Teacher([TeacherID],[Teachername],[Sex],[Brith],[Profession],[Telephone],[HomeAddr],[DepartmentID]) <span class="keyword">Values</span>(<span class="string">&#x27;dep01003&#x27;</span>,<span class="string">&#x27;陈鹤        &#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;1959-12-5&#x27;</span>,<span class="string">&#x27;教授    &#x27;</span>,<span class="string">&#x27;86687656&#x27;</span>,<span class="string">&#x27;东软宿舍12栋306&#x27;</span>,<span class="string">&#x27;Dp01&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Teacher([TeacherID],[Teachername],[Sex],[Brith],[Profession],[Telephone],[HomeAddr],[DepartmentID]) <span class="keyword">Values</span>(<span class="string">&#x27;dep01004&#x27;</span>,<span class="string">&#x27;周江瑞      &#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;1984-6-5&#x27;</span>,<span class="string">&#x27;助教    &#x27;</span>,<span class="string">&#x27;86684332&#x27;</span>,<span class="string">&#x27;东软宿舍3栋306&#x27;</span>,<span class="string">&#x27;Dp01&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Teacher([TeacherID],[Teachername],[Sex],[Brith],[Profession],[Telephone],[HomeAddr],[DepartmentID]) <span class="keyword">Values</span>(<span class="string">&#x27;dep01005&#x27;</span>,<span class="string">&#x27;朱于龙      &#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;1978-5-6&#x27;</span>,<span class="string">&#x27;讲师    &#x27;</span>,<span class="string">&#x27;86687653&#x27;</span>,<span class="string">&#x27;东软宿舍1栋206&#x27;</span>,<span class="string">&#x27;Dp01&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Teacher([TeacherID],[Teachername],[Sex],[Brith],[Profession],[Telephone],[HomeAddr],[DepartmentID]) <span class="keyword">Values</span>(<span class="string">&#x27;dep02001&#x27;</span>,<span class="string">&#x27;雷燕        &#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1973-3-2&#x27;</span>,<span class="string">&#x27;副教授  &#x27;</span>,<span class="string">&#x27;86687651&#x27;</span>,<span class="string">&#x27;东软宿舍1栋106&#x27;</span>,<span class="string">&#x27;Dp02&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Teacher([TeacherID],[Teachername],[Sex],[Brith],[Profession],[Telephone],[HomeAddr],[DepartmentID]) <span class="keyword">Values</span>(<span class="string">&#x27;dep02002&#x27;</span>,<span class="string">&#x27;郭菊        &#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1985-6-7&#x27;</span>,<span class="string">&#x27;助教    &#x27;</span>,<span class="string">&#x27;86680975&#x27;</span>,<span class="string">&#x27;东软宿舍1栋406&#x27;</span>,<span class="string">&#x27;Dp02&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Teacher([TeacherID],[Teachername],[Sex],[Brith],[Profession],[Telephone],[HomeAddr],[DepartmentID]) <span class="keyword">Values</span>(<span class="string">&#x27;dep02003&#x27;</span>,<span class="string">&#x27;刘悠然      &#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;1969-12-9&#x27;</span>,<span class="string">&#x27;教授    &#x27;</span>,<span class="string">&#x27;86685645&#x27;</span>,<span class="string">&#x27;东软宿舍1栋306&#x27;</span>,<span class="string">&#x27;Dp02&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Teacher([TeacherID],[Teachername],[Sex],[Brith],[Profession],[Telephone],[HomeAddr],[DepartmentID]) <span class="keyword">Values</span>(<span class="string">&#x27;dep03001&#x27;</span>,<span class="string">&#x27;胡丽        &#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1968-6-7&#x27;</span>,<span class="string">&#x27;副教授  &#x27;</span>,<span class="string">&#x27;86687904&#x27;</span>,<span class="string">&#x27;东软宿舍21栋108&#x27;</span>,<span class="string">&#x27;Dp03&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Teacher([TeacherID],[Teachername],[Sex],[Brith],[Profession],[Telephone],[HomeAddr],[DepartmentID]) <span class="keyword">Values</span>(<span class="string">&#x27;dep03002&#x27;</span>,<span class="string">&#x27;刘芳        &#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1976-8-6&#x27;</span>,<span class="string">&#x27;讲师    &#x27;</span>,<span class="string">&#x27;86684312&#x27;</span>,<span class="string">&#x27;东软宿舍21栋208&#x27;</span>,<span class="string">&#x27;Dp03&#x27;</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Teacher([TeacherID],[Teachername],[Sex],[Brith],[Profession],[Telephone],[HomeAddr],[DepartmentID]) <span class="keyword">Values</span>(<span class="string">&#x27;dep03003&#x27;</span>,<span class="string">&#x27;雷珍锦      &#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1978-5-6&#x27;</span>,<span class="string">&#x27;讲师    &#x27;</span>,<span class="string">&#x27;86687954&#x27;</span>,<span class="string">&#x27;东软宿舍3栋206&#x27;</span>,<span class="string">&#x27;Dp03&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dbo.sysobjects <span class="keyword">where</span> id <span class="operator">=</span> object_id(N<span class="string">&#x27;[dbo].[Schedule]&#x27;</span>) <span class="keyword">and</span> OBJECTPROPERTY(id, N<span class="string">&#x27;IsUserTable&#x27;</span>) <span class="operator">=</span> <span class="number">1</span>) <span class="keyword">drop</span> <span class="keyword">table</span> [dbo].[Schedule]</span><br><span class="line">GO</span><br><span class="line"><span class="comment">--表 Schedule 的结构</span></span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> Schedule(</span><br><span class="line">TeacherID <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">references</span> Teacher(TeacherID),</span><br><span class="line">CourseID <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">references</span> Course(CourseID),</span><br><span class="line">ClassID <span class="type">char</span>(<span class="number">8</span>)  <span class="keyword">references</span> Class(ClassID),</span><br><span class="line">Semester <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">SchoolYear <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line"><span class="keyword">primary</span> key(TeacherID,CourseID,ClassID)</span><br><span class="line">)</span><br><span class="line"><span class="comment">--表 Schedule 的数据</span></span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Schedule([TeacherID],[CourseID],[ClassID],[Semester],[SchoolYear]) <span class="keyword">Values</span>(<span class="string">&#x27;dep01001&#x27;</span>,<span class="string">&#x27;Dp010003&#x27;</span>,<span class="string">&#x27;Cs010902&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Schedule([TeacherID],[CourseID],[ClassID],[Semester],[SchoolYear]) <span class="keyword">Values</span>(<span class="string">&#x27;dep01001&#x27;</span>,<span class="string">&#x27;Dp010003&#x27;</span>,<span class="string">&#x27;Cs010903&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Schedule([TeacherID],[CourseID],[ClassID],[Semester],[SchoolYear]) <span class="keyword">Values</span>(<span class="string">&#x27;dep01001&#x27;</span>,<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;Cs010901&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Schedule([TeacherID],[CourseID],[ClassID],[Semester],[SchoolYear]) <span class="keyword">Values</span>(<span class="string">&#x27;dep01001&#x27;</span>,<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;Cs010902&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Schedule([TeacherID],[CourseID],[ClassID],[Semester],[SchoolYear]) <span class="keyword">Values</span>(<span class="string">&#x27;dep01002&#x27;</span>,<span class="string">&#x27;Dp010002&#x27;</span>,<span class="string">&#x27;Cs011104&#x27;</span>,<span class="number">2</span>,<span class="number">2011</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Schedule([TeacherID],[CourseID],[ClassID],[Semester],[SchoolYear]) <span class="keyword">Values</span>(<span class="string">&#x27;dep01003&#x27;</span>,<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;Cs011104&#x27;</span>,<span class="number">1</span>,<span class="number">2012</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Schedule([TeacherID],[CourseID],[ClassID],[Semester],[SchoolYear]) <span class="keyword">Values</span>(<span class="string">&#x27;dep01003&#x27;</span>,<span class="string">&#x27;Dp010004&#x27;</span>,<span class="string">&#x27;Cs021001&#x27;</span>,<span class="number">1</span>,<span class="number">2011</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Schedule([TeacherID],[CourseID],[ClassID],[Semester],[SchoolYear]) <span class="keyword">Values</span>(<span class="string">&#x27;dep01005&#x27;</span>,<span class="string">&#x27;Dp010001&#x27;</span>,<span class="string">&#x27;Cs010901&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Schedule([TeacherID],[CourseID],[ClassID],[Semester],[SchoolYear]) <span class="keyword">Values</span>(<span class="string">&#x27;dep01005&#x27;</span>,<span class="string">&#x27;Dp010001&#x27;</span>,<span class="string">&#x27;Cs010902&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Schedule([TeacherID],[CourseID],[ClassID],[Semester],[SchoolYear]) <span class="keyword">Values</span>(<span class="string">&#x27;dep01005&#x27;</span>,<span class="string">&#x27;Dp010001&#x27;</span>,<span class="string">&#x27;Cs021001&#x27;</span>,<span class="number">2</span>,<span class="number">2010</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Schedule([TeacherID],[CourseID],[ClassID],[Semester],[SchoolYear]) <span class="keyword">Values</span>(<span class="string">&#x27;dep02001&#x27;</span>,<span class="string">&#x27;Dp020001&#x27;</span>,<span class="string">&#x27;Cs021001&#x27;</span>,<span class="number">2</span>,<span class="number">2010</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Schedule([TeacherID],[CourseID],[ClassID],[Semester],[SchoolYear]) <span class="keyword">Values</span>(<span class="string">&#x27;dep03001&#x27;</span>,<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;Cs010901&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Schedule([TeacherID],[CourseID],[ClassID],[Semester],[SchoolYear]) <span class="keyword">Values</span>(<span class="string">&#x27;dep03001&#x27;</span>,<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;Cs010902&#x27;</span>,<span class="number">2</span>,<span class="number">2009</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Schedule([TeacherID],[CourseID],[ClassID],[Semester],[SchoolYear]) <span class="keyword">Values</span>(<span class="string">&#x27;dep03001&#x27;</span>,<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;Cs011104&#x27;</span>,<span class="number">2</span>,<span class="number">2011</span>)</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> Schedule([TeacherID],[CourseID],[ClassID],[Semester],[SchoolYear]) <span class="keyword">Values</span>(<span class="string">&#x27;dep03003&#x27;</span>,<span class="string">&#x27;Dp030001&#x27;</span>,<span class="string">&#x27;Cs021001&#x27;</span>,<span class="number">2</span>,<span class="number">2010</span>)</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="1-3-3-单表查询和多表查询"   >
          <a href="#1-3-3-单表查询和多表查询" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-3-3-单表查询和多表查询" class="headerlink" title="1.3.3 单表查询和多表查询"></a>1.3.3 单表查询和多表查询</h3>
      <p>书上p42</p>
<ul>
<li>单表查询<ul>
<li>只从一张表中获取数据</li>
</ul>
</li>
<li>多表查询<ul>
<li>从多张表中获取数据</li>
</ul>
</li>
</ul>

        <h2 id="1-4-数据查询"   >
          <a href="#1-4-数据查询" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-4-数据查询" class="headerlink" title="1.4 数据查询"></a>1.4 数据查询</h2>
      <p>这里是基本查询语句，例子都是单表查询的语句</p>

        <h3 id="1-4-1-SELECT语句"   >
          <a href="#1-4-1-SELECT语句" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-4-1-SELECT语句" class="headerlink" title="1.4.1 SELECT语句"></a>1.4.1 SELECT语句</h3>
      <p>通过<strong>SELECT</strong>语句查询是检索数据库信息的唯一方式，是SQL语句中使用频率最高的语句。</p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span><span class="operator">|</span><span class="keyword">DISTINCT</span>]   [TOP n[<span class="keyword">percent</span>]]<span class="operator">&lt;</span>目标列表达式<span class="operator">&gt;</span>   [，<span class="operator">&lt;</span>目标列表达式<span class="operator">&gt;</span>] …</span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>表名或视图名<span class="operator">&gt;</span>[， <span class="operator">&lt;</span>表名或视图名<span class="operator">&gt;</span> ] …</span><br><span class="line">[ <span class="keyword">WHERE</span> <span class="operator">&lt;</span>条件表达式<span class="operator">&gt;</span> ]<span class="comment">/*有条件的*/</span></span><br><span class="line">[ <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>列名<span class="number">1</span><span class="operator">&gt;</span> [ <span class="keyword">HAVING</span> <span class="operator">&lt;</span>条件表达式<span class="operator">&gt;</span> ] ]</span><br><span class="line"><span class="comment">/*对查询结果按指定列的值分组，该属性列值相等的元组为一个组。通常会在每组中作用聚合函数。*/</span></span><br><span class="line">[ <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>列名<span class="number">2</span><span class="operator">&gt;</span> [ <span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span> ] ]；</span><br><span class="line"><span class="comment">/*对查询结果表按指定列值进行升序或降序排序 */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student</span><br><span class="line"><span class="comment">--查询student表中所有数据</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> student <span class="keyword">as</span> 姓名,sex <span class="keyword">as</span> 性别,studentid <span class="keyword">from</span> student</span><br><span class="line"><span class="keyword">where</span> sex<span class="operator">=</span><span class="string">&#x27;女&#x27;</span></span><br><span class="line"><span class="comment">--从student表中查找student,studentid以及sex列为&#x27;女&#x27;的数据</span></span><br><span class="line"></span><br><span class="line">可以在<span class="keyword">select</span>后加top <span class="number">5</span>来查询前<span class="number">5</span>个数据，或top <span class="number">5</span> <span class="keyword">percent</span>来查询前<span class="number">5</span><span class="operator">%</span>的数据。</span><br><span class="line"></span><br><span class="line">组后加<span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">desc</span>可以降序排序。</span><br><span class="line"></span><br><span class="line">在条件中可以使用<span class="keyword">AND</span>连接条件语句实现多重判断。</span><br><span class="line"><span class="keyword">where</span> sex<span class="operator">=</span><span class="string">&#x27;女&#x27;</span> <span class="keyword">or</span> studentname <span class="keyword">like</span> <span class="string">&#x27;李%&#x27;</span></span><br><span class="line"><span class="operator">%</span>通配任意位数，_通配一位。</span><br></pre></td></tr></table></div></figure>


        <h3 id="1-4-2-条件表达式中常用运算符号"   >
          <a href="#1-4-2-条件表达式中常用运算符号" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-4-2-条件表达式中常用运算符号" class="headerlink" title="1.4.2 条件表达式中常用运算符号"></a>1.4.2 条件表达式中常用运算符号</h3>
      <ol>
<li>比较：<code>&gt;,&gt;=,&lt;,&lt;=,=,!=,&lt;&gt;(,!&gt;,!&lt;)</code></li>
<li>范围：<code>between …… and …… </code>包含边界的</li>
<li>集合：<code>in, NOT IN</code></li>
<li>匹配：<code>like (%:任意个字符，_:单个字符，[]:匹配[]中的任意一个字符，[^ ]不匹配[]中的全部字符)  NOT LIKE</code></li>
<li>空值：<code>is null；is not null</code></li>
<li>逻辑：<code>and，or，not</code></li>
<li>取查询结果某几行<code>(top n[percent])</code></li>
<li>去重结果重复项<code>(distinct)</code></li>
<li>排序：<code>ORDER BY (ASC升序（默认）、DESC降序）</code></li>
</ol>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student</span><br><span class="line"><span class="keyword">where</span> studentname <span class="keyword">not</span> <span class="keyword">like</span> <span class="string">&#x27;王%&#x27;</span></span><br><span class="line">    <span class="keyword">and</span> sex<span class="operator">=</span><span class="string">&#x27;男&#x27;</span></span><br><span class="line"><span class="comment">/*查询所有不姓王的男生*/</span></span><br></pre></td></tr></table></div></figure>


        <h3 id="1-4-3-小实践"   >
          <a href="#1-4-3-小实践" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-4-3-小实践" class="headerlink" title="1.4.3 小实践"></a>1.4.3 小实践</h3>
      <p>查询所有学生的学号、姓名和年龄</p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> StudentID,StudentName,<span class="built_in">floor</span>(DATEDIFF(<span class="keyword">YEAR</span>,Student.Brith,GETDATE())) <span class="keyword">from</span> Student</span><br><span class="line"></span><br><span class="line"><span class="built_in">floor</span>()<span class="comment">/*向下取整*/</span></span><br><span class="line">GetDate()<span class="comment">/*获取当前时间*/</span></span><br><span class="line">datediff(datepart,startdate,enddate)</span><br><span class="line"><span class="comment">/*返回两个日期之间相差的时间*/</span></span><br></pre></td></tr></table></div></figure>


        <h2 id="课后整理"   >
          <a href="#课后整理" class="heading-link"><i class="fas fa-link"></i></a><a href="#课后整理" class="headerlink" title="课后整理"></a>课后整理</h2>
      
        <h3 id="1-取消取值重复的行"   >
          <a href="#1-取消取值重复的行" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-取消取值重复的行" class="headerlink" title="1. 取消取值重复的行"></a>1. 取消取值重复的行</h3>
      <p>在<code>SELECT</code>子句中使用<code>DISTINCT</code>短语</p>
<ul>
<li><code>DISTINCT</code>关键字可以去掉查询结果中的重复行（所有字段相同才为重复），放在select的后面，目标列的前面</li>
</ul>

        <h3 id="2-BETWENN-……-AND-……"   >
          <a href="#2-BETWENN-……-AND-……" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-BETWENN-……-AND-……" class="headerlink" title="2.BETWENN …… AND ……"></a>2.BETWENN …… AND ……</h3>
      <p><code>BETWEEN</code>包含边界值、<code>NOT BETWEEN</code>不包含边界值！</p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WHERE</span> salary <span class="keyword">BETWEEN</span> <span class="number">2000</span> <span class="keyword">AND</span> <span class="number">3000</span></span><br><span class="line"><span class="comment">--工资在2000和3000之间，包括2000和3000的人</span></span><br></pre></td></tr></table></div></figure>

<p>除了使用<code>BETWEEN AND</code>外，还可以使用<code>&gt;= &lt;=</code>的方法来进行范围筛选。</p>

        <h3 id="3-确定集合IN"   >
          <a href="#3-确定集合IN" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-确定集合IN" class="headerlink" title="3. 确定集合IN"></a>3. 确定集合IN</h3>
      <p>可以指定一个表，表中列出所有可能的值，当表达式与表中的任一个值匹配时，就返回TRUE，否则返回FALSE</p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WHERE</span> salary <span class="keyword">IN</span> (<span class="number">2000</span>,<span class="number">1800</span>,<span class="number">4000</span>)</span><br><span class="line"><span class="comment">--工资是2000或1800或4000</span></span><br></pre></td></tr></table></div></figure>

<p>除了使用<code>IN</code>外，还可以使用<code>=</code>来进行判断。</p>

        <h3 id="4-模糊查询：字符匹配LIKE"   >
          <a href="#4-模糊查询：字符匹配LIKE" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-模糊查询：字符匹配LIKE" class="headerlink" title="4. 模糊查询：字符匹配LIKE"></a>4. 模糊查询：字符匹配LIKE</h3>
      <p>如果条件不确定，必须使用<code>LIKE</code>关键字进行模糊查询：</p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> 李<span class="operator">%</span></span><br><span class="line"><span class="comment">--定位姓李的</span></span><br></pre></td></tr></table></div></figure>

<ul>
<li>用<code>LIKE</code>进行字符串匹配，将该字符串叫<code>匹配串</code>。用它与<code>属性值</code>进行比较。</li>
<li>匹配串中的通配符包括：<code>%</code>、<code>_</code></li>
</ul>

        <h3 id="5-通配符"   >
          <a href="#5-通配符" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-通配符" class="headerlink" title="5.通配符"></a>5.通配符</h3>
      <ul>
<li>%：零个或多个任意字符串</li>
<li>_：任意单个字符</li>
<li>[ ]：在指定范围内的单个字符<ul>
<li><code>LIKE &#39;[AB]%&#39;</code>以A或B开头的字符串</li>
</ul>
</li>
<li>[^ ]：不在指定范围内的单个字符<ul>
<li> <code>LIKE &#39;[^AB]%&#39;</code>表示不以A或B开头的字符串</li>
</ul>
</li>
</ul>
<p>由于通配符的存在，在不使用通配符的情况下要加上转义字符<code>\</code>。</p>

        <h3 id="6-空值查询：IS-NULL-IS-NOT-NULL"   >
          <a href="#6-空值查询：IS-NULL-IS-NOT-NULL" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-空值查询：IS-NULL-IS-NOT-NULL" class="headerlink" title="6. 空值查询：IS NULL/IS NOT NULL"></a>6. 空值查询：IS NULL/IS NOT NULL</h3>
      <figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WHERE</span> salary <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">WHERE</span> salary <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br></pre></td></tr></table></div></figure>

<p><code>NULL</code>不是数值，它的含义是没有，因此不能用<code>=</code>等运算符进行判断。</p>

        <h3 id="7-WHERE子句中的逻辑运算符"   >
          <a href="#7-WHERE子句中的逻辑运算符" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-WHERE子句中的逻辑运算符" class="headerlink" title="7. WHERE子句中的逻辑运算符"></a>7. WHERE子句中的逻辑运算符</h3>
      <ul>
<li>AND： 连接两个条件，仅当条件都为真才返回</li>
<li>OR：  连接两个条件，只要其中一个为真就返回</li>
<li>NOT： 否定一个条件，只有条件不成立才返回</li>
</ul>
<p>当一条语句中使用了多个逻辑运算符时，首先求<code>NOT</code>的值，然后求<code>AND</code>的值，最后再求<code>OR</code>的值。</p>

        <h3 id="8-查询语句中的排序"   >
          <a href="#8-查询语句中的排序" class="heading-link"><i class="fas fa-link"></i></a><a href="#8-查询语句中的排序" class="headerlink" title="8. 查询语句中的排序"></a>8. 查询语句中的排序</h3>
      <p>在SQL语句中，通过<code>ORDER BY</code>子句，可以将查询结果进行排序显示</p>
<p>排序默认升序，即使用<code>ASC</code>关键字，如果想要降序排序可以使用<code>DES</code>。</p>
<p>当<code>ORDER BY</code>子句指定了多个排序列时，系统先按照第一个参数进行排列，当出现相同值时，在按照第二个参数进行排序，以此类推。</p>

        <h3 id="9-统计操作"   >
          <a href="#9-统计操作" class="heading-link"><i class="fas fa-link"></i></a><a href="#9-统计操作" class="headerlink" title="9. 统计操作"></a>9. 统计操作</h3>
      <p>在&lt;目标列表达式&gt;中常使用的<code>聚合函数</code>:</p>
<ul>
<li>Count([distinct|all]*)<ul>
<li>统计元组个数</li>
</ul>
</li>
<li>Count([distinct|all]&lt;列名&gt;)<ul>
<li>统计一列中值的个数</li>
</ul>
</li>
<li>sum([distinct|all]&lt;列名&gt;)<ul>
<li>求一列值的总和</li>
</ul>
</li>
<li>avg([distinct|all]&lt;列名&gt;)<ul>
<li>求一列值的平均值</li>
</ul>
</li>
<li>max([distinct|all]&lt;列名&gt;)<ul>
<li>求一列值中的最大值</li>
</ul>
</li>
<li>min([distinct|all]&lt;列名&gt;)<ul>
<li>求一列值中的最小值</li>
</ul>
</li>
</ul>
<p>上述函数，除count(*)外，其他函数均忽略null值。</p>
<p>但是count()指定了字段，就会忽略null值。</p>
<p>例子：</p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> student <span class="keyword">where</span> 系别<span class="operator">=</span><span class="string">&#x27;计科系&#x27;</span></span><br><span class="line"><span class="comment">--查询计算机系的学生人数</span></span><br><span class="line"><span class="keyword">Select</span> <span class="built_in">count</span>(<span class="keyword">distinct</span>(学号)) <span class="keyword">as</span> 人数 <span class="keyword">from</span> choice</span><br><span class="line"><span class="comment">--查询选修了课程的学生人数</span></span><br><span class="line"><span class="keyword">Select</span> <span class="built_in">max</span>(成绩),<span class="built_in">min</span>(成绩),<span class="built_in">avg</span>(成绩) <span class="keyword">from</span> choice <span class="keyword">where</span> 课程号<span class="operator">=</span> <span class="string">&#x27;Dp0101001&#x27;</span></span><br><span class="line"><span class="comment">--查询Dp0101001课程的最高分、最低分和平均成绩</span></span><br></pre></td></tr></table></div></figure>


        <h3 id="10-对查询结果进行分组"   >
          <a href="#10-对查询结果进行分组" class="heading-link"><i class="fas fa-link"></i></a><a href="#10-对查询结果进行分组" class="headerlink" title="10. 对查询结果进行分组"></a>10. 对查询结果进行分组</h3>
      <p>带有<code>GROUP BY</code>子句的查询语句中，SELECT子句后面的结果集只能包含分组依据(GROUP BY子句后面的列)和聚合函数。</p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> …… <span class="keyword">group</span> <span class="keyword">by</span> <span class="operator">&lt;</span>分组依据<span class="operator">&gt;</span></span><br><span class="line">[<span class="keyword">HAVING</span> <span class="operator">&lt;</span>组提取条件表达式<span class="operator">&gt;</span>] </span><br><span class="line"></span><br><span class="line"><span class="comment">--having的作用对象时组，即表示对分组后的记录进行筛选。</span></span><br></pre></td></tr></table></div></figure>

<p>例子：</p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> 学号 <span class="keyword">from</span> choice <span class="keyword">group</span> <span class="keyword">by</span> 学号 <span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>)<span class="operator">&gt;</span><span class="number">3</span></span><br><span class="line"><span class="comment">--查询选修了3门以上课程的学生学号</span></span><br><span class="line"><span class="keyword">select</span> 课程号,<span class="built_in">COUNT</span>(学号) <span class="keyword">AS</span> 考试人数, <span class="built_in">MAX</span>(成绩), <span class="built_in">MIN</span>(成绩),<span class="built_in">AVG</span>(成绩),<span class="built_in">SUM</span>(成绩)</span><br><span class="line"><span class="keyword">from</span> Choice</span><br><span class="line"><span class="keyword">GROUP</span>  <span class="keyword">by</span> 课程号</span><br><span class="line"><span class="keyword">HAVING</span>(<span class="built_in">AVG</span>(成绩)<span class="operator">&gt;</span><span class="number">75</span>)</span><br><span class="line"><span class="comment">--统计出平均分在75分以上每门课程的课程号、考试人数、最高成绩、最低成绩、平均成绩及总成绩。</span></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="11-group-by子句与with-rollup选项"   >
          <a href="#11-group-by子句与with-rollup选项" class="heading-link"><i class="fas fa-link"></i></a><a href="#11-group-by子句与with-rollup选项" class="headerlink" title="11. group by子句与with rollup选项"></a>11. group by子句与with rollup选项</h3>
      <p><code>group by</code>子句将结果集分为若干个组，使用聚合函数可以对每个组内的数据进行信息统计，有时需要对各个组进行汇总运算，则需要在每个分组后加上一条汇总记录，这个任务可以通过<code>with rollup</code>选项实现</p>
 <figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> classid,<span class="built_in">count</span>(<span class="operator">*</span>)   <span class="keyword">from</span> student</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span>  classid <span class="keyword">with</span> <span class="keyword">ROLLUP</span></span><br><span class="line"><span class="comment">--在同一张表中各班有若干名学生，按照班级号分类并进行统计显示</span></span><br></pre></td></tr></table></div></figure>


        <h2 id="网课内容"   >
          <a href="#网课内容" class="heading-link"><i class="fas fa-link"></i></a><a href="#网课内容" class="headerlink" title="网课内容"></a>网课内容</h2>
      <ul>
<li><p>逻辑结构</p>
<ul>
<li>表：用于存放数据，由行和列组成</li>
<li>视图：可以看成是虚拟表或存储查询</li>
<li>索引：用于快速查找所需信息</li>
<li>存储过程：用于完成特定功能的SQL语句集</li>
<li>触发器：一种特殊类型的存储过程</li>
</ul>
</li>
<li><p>物理结构</p>
<ul>
<li>主数据库文件(.mdf)：存放DB的启动信息、部分或全部数据和数据库对象<ul>
<li>必须要有</li>
</ul>
</li>
<li>辅助数据库文件(.ndf)：存放除数据库文件外的数据和数据库对象<ul>
<li>可以根据需要设置一个或多个</li>
</ul>
</li>
<li>事务日志文件(.ldf)：用来存放恢复数据库所需的事物日志信息，记录数据库更新情况<ul>
<li>至少一个</li>
</ul>
</li>
</ul>
</li>
<li><p>系统数据库</p>
<ul>
<li>master<ul>
<li>对用户数据库和SQL Server的操作进行总体控制。</li>
<li>主要记录与sql server相关的所有系统级信息，包括登录账号、系统配置、数据库位置及实例的初始化信息等。</li>
</ul>
</li>
<li>model<ul>
<li>提供创建新用户数据库所需的模板和原型</li>
</ul>
</li>
<li>tempdb<ul>
<li>保存临时表盒其他临时存储过程，是sql server上所有数据库共享的工作空间。</li>
<li>每次sql server启动时，都会重新创建一个<code>tempdb</code>数据库以保证该数据库总是空的；当用户断开数据库连接时，系统会自动删除临时表和存储过程。</li>
</ul>
</li>
<li>msdb<ul>
<li>提供调度信息和作业历史记录所需的存储区，用于代理程序调度警报和作业等。</li>
</ul>
</li>
</ul>
</li>
</ul>

        <h1 id="第2课"   >
          <a href="#第2课" class="heading-link"><i class="fas fa-link"></i></a><a href="#第2课" class="headerlink" title="第2课"></a>第2课</h1>
      
        <h2 id="数据库检索顺序"   >
          <a href="#数据库检索顺序" class="heading-link"><i class="fas fa-link"></i></a><a href="#数据库检索顺序" class="headerlink" title="数据库检索顺序"></a>数据库检索顺序</h2>
      <p>首先检索表名，其次检索<code>WHERE</code>，再检索字段，最后的最后<code>ORDER BY</code></p>

        <h2 id="查询指定的列或全部列"   >
          <a href="#查询指定的列或全部列" class="heading-link"><i class="fas fa-link"></i></a><a href="#查询指定的列或全部列" class="headerlink" title="查询指定的列或全部列"></a>查询指定的列或全部列</h2>
      <p>使用以下的几种方式指定字段列表：</p>
<p>字段列表：</p>
<ul>
<li>*：字段列表为数据源的全部字段</li>
<li>表明.*：多表查询时，指定某个表的全部字段。</li>
<li>字段列表：指定所需要显示的列</li>
</ul>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sex,<span class="built_in">count</span>(HomeAddr)</span><br><span class="line"><span class="comment">--指定了HomeAddr会直接过滤掉NULL</span></span><br><span class="line"><span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> sex</span><br><span class="line"></span><br><span class="line"><span class="comment">--等价于</span></span><br><span class="line"><span class="keyword">SELECT</span> sex,<span class="built_in">count</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="comment">--指定了HomeAddr会直接过滤掉NULL</span></span><br><span class="line"><span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">WHERE</span> HomeAddr <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> sex</span><br></pre></td></tr></table></div></figure>

 <figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(StudentID) 选修人数,<span class="built_in">COUNT</span>(StudentID)<span class="operator">-</span><span class="built_in">COUNT</span>(Grade) 缺考人数,(<span class="built_in">COUNT</span>(StudentID)<span class="operator">-</span><span class="built_in">COUNT</span>(Grade))<span class="operator">/</span><span class="built_in">COUNT</span>(StudentID) 百分比 </span><br><span class="line"><span class="keyword">FROM</span> Grade</span><br><span class="line"><span class="keyword">WHERE</span> CourseID <span class="operator">=</span> <span class="string">&#x27;Dp010001&#x27;</span></span><br></pre></td></tr></table></div></figure>


        <h2 id="网课"   >
          <a href="#网课" class="heading-link"><i class="fas fa-link"></i></a><a href="#网课" class="headerlink" title="网课"></a>网课</h2>
      
        <h3 id="用T-SQL语句创建数据库"   >
          <a href="#用T-SQL语句创建数据库" class="heading-link"><i class="fas fa-link"></i></a><a href="#用T-SQL语句创建数据库" class="headerlink" title="用T-SQL语句创建数据库"></a>用T-SQL语句创建数据库</h3>
      <figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">数据库主体代码：</span><br><span class="line"><span class="keyword">CREATE</span> DATABASE 数据库名</span><br><span class="line"><span class="keyword">ON</span> [<span class="keyword">PRIMARY</span>](……</span><br><span class="line">……)</span><br><span class="line">LOG <span class="keyword">ON</span></span><br><span class="line">(……</span><br><span class="line">……)</span><br></pre></td></tr></table></div></figure>

<p>数据库参数：</p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">NAME <span class="operator">=</span> xkgl_data1,<span class="comment">--指定数据文件或日志文件的逻辑名称</span></span><br><span class="line">FILENAME <span class="operator">=</span> <span class="string">&#x27;d:\db\xkgl_data1.mdf&#x27;</span>,<span class="comment">--指定物理文件或日志文件的物理名称，包括路径和含后缀的文件名。</span></span><br><span class="line">SIZE <span class="operator">=</span> <span class="number">6</span>MB,<span class="comment">--指定数据文件或日志文件的初始大小，默认单位是MB，主文件必须至少是5MB</span></span><br><span class="line">MAXSIZE <span class="operator">=</span> <span class="number">30</span>MB,<span class="comment">--指定数据文件或日志文件可以增长到最大容量，默认单位为MB</span></span><br><span class="line">FILEGROWTH <span class="operator">=</span> <span class="number">2</span>MB<span class="comment">--指定数据文件或日志文件的增长幅度，默认单位为MB,也可以按百分比增长。</span></span><br></pre></td></tr></table></div></figure>

<p>数据库分为3步：</p>
<ol>
<li>定义<strong>数据库的名字</strong></li>
<li>定义<strong>数据文件</strong></li>
<li>定义<strong>日志文件</strong></li>
</ol>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE teacher</span><br><span class="line"><span class="keyword">ON</span> <span class="keyword">PRIMARY</span>    <span class="comment">/*创建主要数据文件*/</span></span><br><span class="line">(</span><br><span class="line">  NAME <span class="operator">=</span> teacher_data,</span><br><span class="line">  FILENAME <span class="operator">=</span> <span class="string">&#x27;D:\db\teacher_data.mdf&#x27;</span>,</span><br><span class="line">  SIZE <span class="operator">=</span> <span class="number">5</span>MB,<span class="comment">--默认字节单位MB可以省略</span></span><br><span class="line">  MAXSIZE <span class="operator">=</span> <span class="number">10</span>,<span class="comment">-- 文件最大容量10MB</span></span><br><span class="line">  FILEGROWTH <span class="operator">=</span> <span class="number">15</span><span class="operator">%</span><span class="comment">-- 增长量为文件容量15%</span></span><br><span class="line">)</span><br><span class="line">LOG <span class="keyword">ON</span>    <span class="comment">/*创建日志文件*/</span></span><br><span class="line">(</span><br><span class="line">  NAME <span class="operator">=</span> teacher_log,</span><br><span class="line">  FILENAME <span class="operator">=</span> <span class="string">&#x27;D:\db\teacher_log.LDF&#x27;</span>,</span><br><span class="line">  SIZE <span class="operator">=</span> <span class="number">500</span>KB,       <span class="comment">/*初始容量，KB单位不能省略*/</span></span><br><span class="line">  MAXSIZE <span class="operator">=</span> UNLIMITED,  <span class="comment">/*日志文件最大容量不受限制*/</span></span><br><span class="line">  FILEGROWTH <span class="operator">=</span> <span class="number">500</span>KB  <span class="comment">/*增长量KB不能省略*/</span></span><br><span class="line">)</span><br></pre></td></tr></table></div></figure>


        <h3 id="删除数据库"   >
          <a href="#删除数据库" class="heading-link"><i class="fas fa-link"></i></a><a href="#删除数据库" class="headerlink" title="删除数据库"></a>删除数据库</h3>
      <ol>
<li>使用SSMS工具删除，直接右键数据库，选择删除进行删除。</li>
<li>使用T-SQL语句进行删除</li>
</ol>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> DATABASE <span class="operator">&lt;</span>数据库名<span class="operator">&gt;</span> [[,<span class="operator">&lt;</span>数据库名<span class="operator">&gt;</span>]…]</span><br></pre></td></tr></table></div></figure>


        <h3 id="数据库的相关操作"   >
          <a href="#数据库的相关操作" class="heading-link"><i class="fas fa-link"></i></a><a href="#数据库的相关操作" class="headerlink" title="数据库的相关操作"></a>数据库的相关操作</h3>
      <ol>
<li>分离数据库<ul>
<li>分离数据库就是将某个数据库从SQL Server数据库列表中删除，使其不再被SQL Server管理和使用，但该数据库的<strong>数据文件和对应的日志文件完好无损。</strong>分离成功后，我们就可以吧数据文件和对应的日志文件拷贝到其他磁盘中作为备份保存。</li>
<li>使用SSMS工具分离：<ul>
<li>右键数据库选择<code>任务</code>下的<code>分离</code>命令进行分离</li>
<li>只有在<strong>“使用本数据库的连接”数为0</strong>时，该数据库才能分离。</li>
</ul>
</li>
</ul>
</li>
<li>附加数据库<ul>
<li>附加数据库就是将一个备份磁盘中的<strong>数据文件和对应的日志文件</strong>拷贝到需要的计算机，并将其添加到某个SQL Server数据库服务器中，由该服务器来管理和使用这个数据库。</li>
<li>使用SSMS工具附加数据库：<ul>
<li>右键数据库结点，选择<code>附加</code>命令。</li>
<li>出现<code>附加数据库</code>对话框，单机<code>添加</code>按钮，出现<code>定位数据库文件</code>对话框，在这个对话框里，默认只显示数据库的主要文件，即<code>mdf</code>文件</li>
</ul>
</li>
</ul>
</li>
<li>改变数据库状态(脱机、联机)<ul>
<li>数据库有<code>脱机</code>与<code>联网</code>两种状态，当一个数据库处于<strong>可操作、可查询</strong>的状态时就是<strong>联机状态</strong>，而一个数据库尽管可以看到其名字出现在数据库节点中，但对其<strong>不能执行任何有效的数据库操作</strong>时就是<strong>脱机状态</strong>。</li>
<li>用SSMS工具脱机：<ul>
<li>右键数据库，选择<code>任务</code>下的<code>脱机</code>命令。</li>
<li>弹出<code>使数据库脱机</code>对话框，单击<code>关闭</code>即可完成。</li>
</ul>
</li>
<li>用SSMS工具联机：<ul>
<li>右键数据库，选择<code>任务</code>下的<code>联机</code>命令。</li>
<li>弹出<code>使数据库脱机</code>对话框，单击<code>关闭</code>即可完成。</li>
</ul>
</li>
</ul>
</li>
</ol>

        <h3 id="完整性约束"   >
          <a href="#完整性约束" class="heading-link"><i class="fas fa-link"></i></a><a href="#完整性约束" class="headerlink" title="完整性约束"></a>完整性约束</h3>
      <p>完整性约束是为保证数据库中数据的<strong>正确性和相容性</strong>，而对关系模型提出的某种<strong>约束条件或规则</strong>。</p>
<ol>
<li>取值为空或者非空的约束<ul>
<li>取值为空或者非空的约束是对<strong>表中某个字段的取值进行限制</strong>。</li>
<li>取值为空表示字段可以<strong>取空值</strong>。</li>
<li>取值为空表示字段<strong>不可以取空值</strong>。</li>
<li>空值表示不知道不确定的意思，不同于0。</li>
</ul>
</li>
<li>唯一性约束<ul>
<li>唯一性约束是指<strong>基本表在一个字段或者多个字段的组合上的取值唯一。</strong></li>
<li>定义了唯一性约束的字段称为唯一键，唯一键可为空，<strong>最多只能取一个空值</strong>。</li>
</ul>
</li>
<li>主码约束<ul>
<li>主码约束是指<strong>将表中一个字段或者多个字段的组合定义为该表的主码</strong>，<strong>主码的取值不能为空</strong>，且表中任意两行在主码上的<strong>取值不能相同</strong>。(<strong>唯一且非空</strong>)</li>
</ul>
</li>
<li>外码约束<ul>
<li>外码约束是指将表中的一个字段定义为<strong>外码</strong>，外码的取值可以<strong>为空</strong>或者<strong>等于另外一张表中某个元组的主码值</strong>。</li>
<li>含外码的这张表叫子表，另一张表叫父表。</li>
</ul>
</li>
<li>默认值约束<ul>
<li>默认值约束是指<strong>为某个字段指定默认值</strong>，当为某个字段指定默认值后，想表中输入数据时如果不为该字段指定其它值，系统将取默认值。</li>
</ul>
</li>
<li>列值约束<ul>
<li>列值约束是用来指定某个字段的<strong>取值范围</strong>。</li>
</ul>
</li>
</ol>
<p>主码约束和唯一性约束的区别：</p>
<ol>
<li>在一个基本表中只能定义一个主码约束，但可定义多个唯一性约束。</li>
<li>被指定为主码的字段，<strong>不能出现空值</strong>，而被定义为唯一键的字段，则<strong>允许为空，但最多只能取一个空值</strong>。</li>
</ol>

        <h3 id="创建表"   >
          <a href="#创建表" class="heading-link"><i class="fas fa-link"></i></a><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h3>
      <p>表是数据库中最重要的对象，用于存储用户数据，</p>
<p>创建新标的实质是定义新表的结构，其中有三大要素需要确定，分别是：</p>
<ul>
<li>列名(易于理解，不可重名，长度合适)</li>
<li>数据类型</li>
<li>约束条件</li>
</ul>
<p>数据类型：</p>
<ul>
<li>数值型<ul>
<li>整形<ul>
<li>tinyint</li>
<li>smallint</li>
<li>int</li>
<li>bigint</li>
</ul>
</li>
<li>定点型<ul>
<li>decimal</li>
<li>numeric</li>
</ul>
</li>
<li>浮点型<ul>
<li>float</li>
<li>real</li>
</ul>
</li>
</ul>
</li>
<li>字符型<ul>
<li>普通字符型<ul>
<li>char</li>
<li>varchar</li>
<li>text</li>
</ul>
</li>
<li>Unicode字符型<ul>
<li>nchar</li>
<li>nvarchar</li>
<li>ntext</li>
</ul>
</li>
</ul>
</li>
<li>日期时间型<ul>
<li>datatime</li>
<li>smalldatetime</li>
</ul>
</li>
<li>货币型<ul>
<li>money</li>
<li>smallmoney</li>
</ul>
</li>
<li>二进制字符型<ul>
<li>binary</li>
<li>varbinary</li>
<li>image</li>
</ul>
</li>
</ul>
<ol>
<li>用SSMS工具来创建表</li>
</ol>
<ul>
<li>右键<code>数据库</code>后选择<code>表</code>中的<code>表</code>命令后，定义列名、数据类型以及设定是否允许Null值。</li>
<li>右键<code>列名</code>可以选择设置主键。</li>
<li>所有的特殊操作都右键操作。</li>
</ul>
<ol start="2">
<li>用T-SQL语句创建表<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span>(</span><br><span class="line">  <span class="operator">&lt;</span>列名<span class="operator">&gt;</span><span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span>[列级完整性约束的定义]</span><br><span class="line">  [,<span class="operator">&lt;</span>列名<span class="operator">&gt;</span><span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span>[列级完整性约束的定义]……]</span><br><span class="line">  [,表级完整性约束的定义]</span><br><span class="line">)</span><br></pre></td></tr></table></div></figure></li>
</ol>

        <h3 id="完整性约束名"   >
          <a href="#完整性约束名" class="heading-link"><i class="fas fa-link"></i></a><a href="#完整性约束名" class="headerlink" title="完整性约束名"></a>完整性约束名</h3>
      <ol>
<li>取值为空或者非空约束<ul>
<li>NULL/NOT NULL</li>
<li>只能定义为“列级完整性约束”</li>
<li><code>sname char(10) NOT NULL</code></li>
<li>默认是允许为空</li>
</ul>
</li>
<li>唯一性约束<ul>
<li>UNIQUE</li>
<li>可以定义为“列级完整性约束”，也可以定义为“表级完整性约束”。<ul>
<li>列级约束：在定义列时定义唯一约束<ul>
<li><code>&lt;列名&gt;&lt;数据类型&gt;unique</code></li>
</ul>
</li>
<li>表级约束：在定义完列之后定义唯一约束<ul>
<li><code>unique(&lt;列名序列&gt;)</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>主码约束<ul>
<li>PRIMARY KEY</li>
<li>可以定义为“列级完整性约束”，也可以定义为“表级完整性约束”。<ul>
<li>列级约束：在定义列时定义主码(仅用于主码由一个字段构成)<ul>
<li><code>&lt;列名&gt;&lt;数据类型&gt;PRIMARY KEY</code></li>
</ul>
</li>
<li>表级约束：在定义完列时定义主码(用于主码由一个字段或者多个字段构成)<ul>
<li><code>PRIMARY KEY(&lt;列名序列&gt;)</code></li>
</ul>
</li>
</ul>
</li>
<li>主码由一个字段或者多个字段构成时，只能定义为“表级完整性约束”。</li>
</ul>
</li>
<li>外码约束<ul>
<li>参照完整性</li>
<li>FOREIGN KEY</li>
<li>可以定义为“列级完整性约束”，也可定义为“表级完整性约束”。<ul>
<li>列级约束：在定义列时定义外码<ul>
<li><code>&lt;列名&gt; &lt;数据类型&gt; REFERENCES &lt;父表名&gt;(&lt;父表的主码列名&gt;)</code></li>
</ul>
</li>
<li>表级约束：在定义完列时定义外码<ul>
<li><code>FOREIGN KEY (&lt;列名&gt;) REFERENCES</code> &lt;父表名&gt; (&lt;父表的主码列名&gt;)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>默认值约束<ul>
<li>DEFAULT</li>
<li>只能定义为“列级完整性约束”</li>
<li><code>sex char(2) DEFAULT &#39;女&#39;</code></li>
</ul>
</li>
<li>列值约束：限制列的取值范围的约束<ul>
<li>CHECK</li>
<li>可以定义为“列级完整性约束”，也可以为“表级完整性约束”<ul>
<li>列级约束：在定义列时定义约束<ul>
<li><code>&lt;列名&gt; &lt;数据类型&gt; CHECK &lt;表达式&gt;</code></li>
</ul>
</li>
<li>表级约束：在定义完列时定义约束<ul>
<li><code>CHECK &lt;表达式&gt;</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> Class(</span><br><span class="line">  ClassID <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">primary</span> key,</span><br><span class="line">  ClassName <span class="type">varchar</span>(<span class="number">80</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">  Monitor <span class="type">char</span>(<span class="number">8</span>),</span><br><span class="line">  StudentNum <span class="type">int</span> <span class="keyword">check</span>(StudentNum<span class="operator">&gt;</span><span class="number">0</span>),</span><br><span class="line">  DepartmentID <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">references</span></span><br><span class="line">  Department(DepartmentID)</span><br><span class="line">)</span><br></pre></td></tr></table></div></figure>




        <h1 id="第3课"   >
          <a href="#第3课" class="heading-link"><i class="fas fa-link"></i></a><a href="#第3课" class="headerlink" title="第3课"></a>第3课</h1>
      
        <h2 id="JOIN"   >
          <a href="#JOIN" class="heading-link"><i class="fas fa-link"></i></a><a href="#JOIN" class="headerlink" title="JOIN"></a>JOIN</h2>
      <figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Course.CourseID,Course.CourseName,Student.StudentName,Grade.StudentID</span><br><span class="line"><span class="keyword">FROM</span> Course </span><br><span class="line"><span class="keyword">JOIN</span> Grade </span><br><span class="line"><span class="keyword">ON</span> Course.CourseID <span class="operator">=</span> Grade.CourseID</span><br><span class="line"><span class="keyword">JOIN</span> Student</span><br><span class="line"><span class="keyword">ON</span> Student.StudentID<span class="operator">=</span>Grade.StudentID</span><br></pre></td></tr></table></div></figure>

<p><code>JOIN</code>多表连到一起要分开<code>JOIN ON</code></p>
<p>指定的列名前面要加表明避免产生二义性，为了化简可以简写表明</p>

        <h2 id="网课-1"   >
          <a href="#网课-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#网课-1" class="headerlink" title="网课"></a>网课</h2>
      
        <h3 id="用T-SQL语句修改表结构"   >
          <a href="#用T-SQL语句修改表结构" class="heading-link"><i class="fas fa-link"></i></a><a href="#用T-SQL语句修改表结构" class="headerlink" title="用T-SQL语句修改表结构"></a>用T-SQL语句修改表结构</h3>
      <p>在T-SQL中采用<code>ALTER TABLE</code>语句修改表结构，通过ALTER TABLE语句可以对表添加列、删除列、修改列的定义，也可以添加和删除约束。</p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line">[<span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> <span class="operator">&lt;</span>列名<span class="operator">&gt;</span> <span class="operator">&lt;</span>新数据类型<span class="operator">&gt;</span>] <span class="comment">--修改列定义</span></span><br><span class="line"><span class="operator">|</span>[<span class="keyword">ADD</span> <span class="operator">&lt;</span>列名<span class="operator">&gt;</span> <span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span> [列级完整性约束定义]]  <span class="comment">--添加新列</span></span><br><span class="line"><span class="operator">|</span>[<span class="keyword">DROP</span> <span class="keyword">COLUMN</span> <span class="operator">&lt;</span>列名<span class="operator">&gt;</span>] <span class="comment">--删除列</span></span><br><span class="line"><span class="operator">|</span>[<span class="keyword">ADD</span> [<span class="keyword">CONSTRAINT</span> <span class="operator">&lt;</span>约束名<span class="operator">&gt;</span>]约束定义]  <span class="comment">--增加约束</span></span><br><span class="line"><span class="operator">|</span>[<span class="keyword">DROP</span> <span class="operator">&lt;</span>约束名<span class="operator">&gt;</span>]  <span class="comment">--删除约束</span></span><br></pre></td></tr></table></div></figure>


        <h3 id="删除数据表"   >
          <a href="#删除数据表" class="heading-link"><i class="fas fa-link"></i></a><a href="#删除数据表" class="headerlink" title="删除数据表"></a>删除数据表</h3>
      <ol>
<li>用SSMS工具删除数据表<ul>
<li>右键表，选择删除命令，点击确定即可删除</li>
</ul>
</li>
<li>用T-SQL语句删除数据表<ul>
<li><code>DROP TABLE &lt;表名&gt;[[,&lt;表名&gt;]……]</code></li>
</ul>
</li>
</ol>

        <h3 id="数据库关系图"   >
          <a href="#数据库关系图" class="heading-link"><i class="fas fa-link"></i></a><a href="#数据库关系图" class="headerlink" title="数据库关系图"></a>数据库关系图</h3>
      <p>在SQL Server中，可以<strong>使用数据库关系图来创建和管理一个数据库中表之间的关系</strong>。数据库关系图作为数据库的一部分，存储在数据库中。关系图的建立可以使表间的关系以图形的方式加以显示，更加清晰的表现出表之间的关联。</p>
<ol>
<li>使用ssms工具创建关系图<ul>
<li>右击数据库下数据库关系图，选择新建数据库关系图命令后添加表即可。</li>
</ul>
</li>
</ol>

        <h3 id="数据的导入与导出"   >
          <a href="#数据的导入与导出" class="heading-link"><i class="fas fa-link"></i></a><a href="#数据的导入与导出" class="headerlink" title="数据的导入与导出"></a>数据的导入与导出</h3>
      <p>右键数据库选择导入数据导入就行了</p>

        <h3 id="常用字符串函数"   >
          <a href="#常用字符串函数" class="heading-link"><i class="fas fa-link"></i></a><a href="#常用字符串函数" class="headerlink" title="常用字符串函数"></a>常用字符串函数</h3>
      <ul>
<li>LTRIM()<ul>
<li>函数把字符串头部(左边)的空格去掉</li>
</ul>
</li>
<li>RTRIM()<ul>
<li>函数把字符串尾部(右边)的空格去掉</li>
</ul>
</li>
<li>LEFT()、RIGHT()、SUBSTRING()<ul>
<li>函数返回部分字符串</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> RTRIM(StundentName)</span><br><span class="line"><span class="keyword">FROM</span> student</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUBSTRING</span>(<span class="string">&#x27;abc&#x27;</span>,<span class="number">2</span>,<span class="number">2</span>) <span class="comment">--取abc中第二个开始后的两个字符</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">RIGHT</span>(<span class="string">&#x27;abc&#x27;</span>,<span class="number">2</span>) <span class="comment">-- 与上同</span></span><br></pre></td></tr></table></div></figure>


        <h3 id="UPDATAE-lt-表名-gt-SET-lt-列名-gt"   >
          <a href="#UPDATAE-lt-表名-gt-SET-lt-列名-gt" class="heading-link"><i class="fas fa-link"></i></a><a href="#UPDATAE-lt-表名-gt-SET-lt-列名-gt" class="headerlink" title="UPDATAE &lt;表名&gt; SET &lt;列名&gt;"></a>UPDATAE &lt;表名&gt; SET &lt;列名&gt;</h3>
      
        <h3 id="内连接"   >
          <a href="#内连接" class="heading-link"><i class="fas fa-link"></i></a><a href="#内连接" class="headerlink" title="内连接"></a>内连接</h3>
      <ul>
<li>自连接是一种特殊的内连接，相互连接两张表在物理上的是同一张表，但必须用别名将其在逻辑上划分为两张表。</li>
<li>由于所有属性名都是同名属性，因此必须使用别名前缀。</li>
</ul>

        <h3 id="外连接"   >
          <a href="#外连接" class="heading-link"><i class="fas fa-link"></i></a><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h3>
      <ul>
<li>内连接要求满足条件的记录才会显示，<strong>外连接是只限制一张表中的数据必须满足连接条件，而另一张表中的数据可以不满足连接条件的连接方式，</strong>外连接中的两张表的关系是不平等的。</li>
</ul>
<p>外连接的三中类型：</p>
<ol>
<li>左外连接(LEFT OUTER JOIN)<ul>
<li>左外连接即在连接两表时，不管右表中是否有匹配数据，结果将保留左表中所有行。左表是主表，右边满足条件的记录才显示。</li>
</ul>
</li>
<li>右外连接(RIGHT OUTER JOIN)<ul>
<li>右连接原理同上</li>
</ul>
</li>
<li>全外连接(FULL OUTER JOIN)<ul>
<li>原理一样，没有数据的时候用NULL来代理</li>
</ul>
</li>
</ol>

        <h1 id="第4课"   >
          <a href="#第4课" class="heading-link"><i class="fas fa-link"></i></a><a href="#第4课" class="headerlink" title="第4课"></a>第4课</h1>
      
        <h2 id="课程回顾"   >
          <a href="#课程回顾" class="heading-link"><i class="fas fa-link"></i></a><a href="#课程回顾" class="headerlink" title="课程回顾"></a>课程回顾</h2>
      
        <h3 id="查询计算机系的教师所有信息"   >
          <a href="#查询计算机系的教师所有信息" class="heading-link"><i class="fas fa-link"></i></a><a href="#查询计算机系的教师所有信息" class="headerlink" title="查询计算机系的教师所有信息"></a>查询计算机系的教师所有信息</h3>
      <figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> t.<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> Teacher t</span><br><span class="line"><span class="keyword">JOIN</span> Department d</span><br><span class="line"><span class="keyword">on</span> t.DepartmentID <span class="operator">=</span> d.DepartmentID</span><br><span class="line"><span class="keyword">where</span> DepartmentName<span class="operator">=</span><span class="string">&#x27;计算机系&#x27;</span></span><br></pre></td></tr></table></div></figure>


        <h3 id="查询信管系的所有学生信息"   >
          <a href="#查询信管系的所有学生信息" class="heading-link"><i class="fas fa-link"></i></a><a href="#查询信管系的所有学生信息" class="headerlink" title="查询信管系的所有学生信息"></a>查询信管系的所有学生信息</h3>
      <figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s.<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> Student s</span><br><span class="line"><span class="keyword">JOIN</span> Class c</span><br><span class="line"><span class="keyword">ON</span> c.ClassID <span class="operator">=</span> s.ClassID</span><br><span class="line"><span class="keyword">JOIN</span> Department d</span><br><span class="line"><span class="keyword">ON</span> d.DepartmentID <span class="operator">=</span> c.DepartmentID</span><br><span class="line"><span class="keyword">WHERE</span> DepartmentName<span class="operator">=</span><span class="string">&#x27;信管系&#x27;</span></span><br></pre></td></tr></table></div></figure>


        <h3 id="左外查询"   >
          <a href="#左外查询" class="heading-link"><i class="fas fa-link"></i></a><a href="#左外查询" class="headerlink" title="左外查询"></a>左外查询</h3>
      <p>左外连接确保左边的数据都会出现在表中，右外连接同理</p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> <span class="number">1</span> <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> <span class="number">2</span> <span class="keyword">ON</span> XXXX</span><br></pre></td></tr></table></div></figure>


        <h3 id="查询所有学生的学号，姓名，课程编号，成绩"   >
          <a href="#查询所有学生的学号，姓名，课程编号，成绩" class="heading-link"><i class="fas fa-link"></i></a><a href="#查询所有学生的学号，姓名，课程编号，成绩" class="headerlink" title="查询所有学生的学号，姓名，课程编号，成绩"></a>查询所有学生的学号，姓名，课程编号，成绩</h3>
      <figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s.StudentID,StudentName,CourseID,Grade</span><br><span class="line"><span class="keyword">FROM</span> Student s</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Class c</span><br><span class="line"><span class="keyword">ON</span> c.ClassID <span class="operator">=</span> s.ClassID</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Grade g</span><br><span class="line"><span class="keyword">ON</span> g.StudentID <span class="operator">=</span> s.StudentID</span><br></pre></td></tr></table></div></figure>


        <h2 id="条件转换"   >
          <a href="#条件转换" class="heading-link"><i class="fas fa-link"></i></a><a href="#条件转换" class="headerlink" title="条件转换"></a>条件转换</h2>
      <p>有时在查询中需要<strong>将结果以另外一种形式显示出来</strong>可以使用<code>CASE</code>子句指定数据的转换</p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Teachername,Profession,</span><br><span class="line"><span class="keyword">CASE</span> </span><br><span class="line">  <span class="keyword">WHEN</span> Profession <span class="operator">=</span> <span class="string">&#x27;助教&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;初级&#x27;</span></span><br><span class="line">  <span class="keyword">WHEN</span> Profession <span class="operator">=</span> <span class="string">&#x27;讲师&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;中级&#x27;</span></span><br><span class="line">  <span class="keyword">ELSE</span> <span class="string">&#x27;高级&#x27;</span></span><br><span class="line"><span class="keyword">END</span> 等级</span><br><span class="line"><span class="keyword">FROM</span> Teacher</span><br></pre></td></tr></table></div></figure>

<p>用<code>CASE</code>时候，<code>SELECT</code>结尾一定要加<code>,</code>！</p>
<p>上面是搜索型<code>CASE</code>函数，可以使用逻辑运算符。</p>
<p>下面一种是简单型<code>CASE</code>！<strong>无法使用逻辑运算符</strong>！</p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> StudentID,Sex,</span><br><span class="line"><span class="keyword">CASE</span> Sex</span><br><span class="line">	<span class="keyword">WHEN</span> <span class="string">&#x27;男&#x27;</span> <span class="keyword">THEN</span>  <span class="string">&#x27;先生&#x27;</span></span><br><span class="line">	<span class="keyword">WHEN</span> <span class="string">&#x27;女&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;女士&#x27;</span></span><br><span class="line">	<span class="keyword">ELSE</span> <span class="string">&#x27;不详&#x27;</span></span><br><span class="line"><span class="keyword">END</span> 称呼</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br></pre></td></tr></table></div></figure>

<p><strong>区别就是简单型<code>CASE</code>指定了列，可以每一个<code>WHEN</code>指定。</strong></p>
<p><strong><code>WHEN</code>具有逻辑优先的！如果按类似分数分类，一定要分高的先<code>WHEN</code>！</strong></p>

        <h2 id="子查询"   >
          <a href="#子查询" class="heading-link"><i class="fas fa-link"></i></a><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h2>
      
        <h3 id="不相关子查询"   >
          <a href="#不相关子查询" class="heading-link"><i class="fas fa-link"></i></a><a href="#不相关子查询" class="headerlink" title="不相关子查询"></a>不相关子查询</h3>
      <p>没有内层查询，外层依然能查询出数据，只是不够精确而已。</p>
<p>查询与张宏同日生的同学：</p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> StudentID,StudentName,Birth</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> Birth <span class="operator">=</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> Birth</span><br><span class="line">	<span class="keyword">FROM</span> Student</span><br><span class="line">	<span class="keyword">WHERE</span> StudentName <span class="operator">=</span> <span class="string">&#x27;张宏&#x27;</span>)</span><br></pre></td></tr></table></div></figure>

<p>子查询部分不能使用<code>ORDER BY</code>排序。</p>

        <h2 id="交集-intersect"   >
          <a href="#交集-intersect" class="heading-link"><i class="fas fa-link"></i></a><a href="#交集-intersect" class="headerlink" title="交集 intersect"></a>交集 intersect</h2>
      
        <h2 id="子查询的谓词"   >
          <a href="#子查询的谓词" class="heading-link"><i class="fas fa-link"></i></a><a href="#子查询的谓词" class="headerlink" title="子查询的谓词"></a>子查询的谓词</h2>
      <p>子查询的结果可以是<strong>单个属性值</strong>，也可以是一个<strong>集合</strong></p>
<p>子查询只<strong>返回一个值</strong>时：用<strong>比较符或IN/NOT IN</strong></p>
<p>子查询<strong>返回多个值</strong>时：</p>
<ul>
<li>(IN或NOT)：是或不是集合中的一个值</li>
<li>(&lt;&gt;,&lt;,&gt;)ALL</li>
</ul>
<blockquote>
<blockquote>
<p>没记完</p>
</blockquote>
</blockquote>

        <h2 id="带有EXISIT"   >
          <a href="#带有EXISIT" class="heading-link"><i class="fas fa-link"></i></a><a href="#带有EXISIT" class="headerlink" title="带有EXISIT"></a>带有EXISIT</h2>
      <blockquote>
<blockquote>
<p>依然没记完</p>
</blockquote>
</blockquote>

        <h2 id="网课-2"   >
          <a href="#网课-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#网课-2" class="headerlink" title="网课"></a>网课</h2>
      
        <h3 id="嵌套查询"   >
          <a href="#嵌套查询" class="heading-link"><i class="fas fa-link"></i></a><a href="#嵌套查询" class="headerlink" title="嵌套查询"></a>嵌套查询</h3>
      <ul>
<li><p>子查询可以被用于：</p>
<ul>
<li>集合测试</li>
<li>比较测试</li>
<li>存在性测试</li>
</ul>
</li>
<li><p>使用子查询需要注意</p>
<ul>
<li>子查询可以嵌套多层</li>
<li>子查询需要圆括号<code>()</code>括起来</li>
<li>子查询不能使用<code>ORDER BY</code>语句</li>
</ul>
</li>
<li><p>ANY</p>
</li>
<li><p>ALL</p>
</li>
</ul>
<p>带有EXISTS的子查询只返回布尔值</p>
<p>存在性子查询先进行父查询，然后进行子查询</p>

        <h2 id="网课-3"   >
          <a href="#网课-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#网课-3" class="headerlink" title="网课"></a>网课</h2>
      
        <h3 id="视图"   >
          <a href="#视图" class="heading-link"><i class="fas fa-link"></i></a><a href="#视图" class="headerlink" title="视图"></a>视图</h3>
      <figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> 名称</span><br><span class="line"><span class="keyword">WITH</span> ENCRYPTION <span class="comment">--加密</span></span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> ……</span><br><span class="line"><span class="keyword">SELECT</span> ……</span><br><span class="line"></span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">CHECK</span> OPTION</span><br><span class="line"><span class="comment">--通过视图进行的修改，必须也能通过该视图看到修改后的结果。</span></span><br></pre></td></tr></table></div></figure>


        <h3 id="索引"   >
          <a href="#索引" class="heading-link"><i class="fas fa-link"></i></a><a href="#索引" class="headerlink" title="索引"></a>索引</h3>
      
        <h4 id="聚集索引"   >
          <a href="#聚集索引" class="heading-link"><i class="fas fa-link"></i></a><a href="#聚集索引" class="headerlink" title="聚集索引"></a>聚集索引</h4>
      <p>物理空间上连续</p>

        <h4 id="非聚集索引"   >
          <a href="#非聚集索引" class="heading-link"><i class="fas fa-link"></i></a><a href="#非聚集索引" class="headerlink" title="非聚集索引"></a>非聚集索引</h4>
      
        <h3 id="变量及打印"   >
          <a href="#变量及打印" class="heading-link"><i class="fas fa-link"></i></a><a href="#变量及打印" class="headerlink" title="变量及打印"></a>变量及打印</h3>
      
        <h4 id="变量类型"   >
          <a href="#变量类型" class="heading-link"><i class="fas fa-link"></i></a><a href="#变量类型" class="headerlink" title="变量类型"></a>变量类型</h4>
      <ul>
<li>局部变量<ul>
<li>局部变量前加<code>@</code>，如<code>@mystr</code></li>
<li>局部变量由用户定义，使用时先声明，再赋值</li>
</ul>
</li>
<li>全局变量<ul>
<li>全局变量前加<code>@@</code>，如<code>@@error</code></li>
<li>全局变量由系统应以和维护，我们只能读取，不能修改全局变量的值。</li>
</ul>
</li>
</ul>

        <h4 id="声明局部变量"   >
          <a href="#声明局部变量" class="heading-link"><i class="fas fa-link"></i></a><a href="#声明局部变量" class="headerlink" title="声明局部变量"></a>声明局部变量</h4>
      <ul>
<li>基本格式</li>
</ul>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> @变量名 数据类型 [,……n]</span><br></pre></td></tr></table></div></figure>

<p>注：一次可以声明多个变量，变量用逗号隔开，所有局部变量在声明后均初始化为NULL</p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@stuName</span> <span class="type">CHAR</span>(<span class="number">8</span>)</span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@stuBirthday</span> DATETIME</span><br><span class="line"><span class="comment">--等价于</span></span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@stuName</span> <span class="type">CHAR</span>(<span class="number">8</span>),<span class="variable">@stuBirthday</span> DATETIME</span><br></pre></td></tr></table></div></figure>

<ul>
<li>局部变量赋值<ul>
<li>局部变量赋值的方法有<code>SET</code>和<code>SELECT</code>两种，<code>SET</code>语句<strong>一次只能给一个变量赋值</strong>，<code>SELECT</code>语句<strong>可同时为多个变量赋值</strong>，语法如下：</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> @变量名 <span class="operator">=</span> 值</span><br><span class="line"><span class="keyword">SELECT</span> @变量名 <span class="operator">=</span> 值</span><br></pre></td></tr></table></div></figure>

<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> <span class="variable">@stuName</span> <span class="operator">=</span> <span class="string">&#x27;张三&#x27;</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@stuBirthday</span> <span class="operator">=</span> <span class="string">&#x27;1998-10-12&#x27;</span></span><br><span class="line"><span class="comment">--等价于</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@stuName</span> <span class="operator">=</span> <span class="string">&#x27;张三&#x27;</span>,<span class="variable">@stuBirthday</span> <span class="operator">=</span> <span class="string">&#x27;1998-10-12&#x27;</span></span><br><span class="line"></span><br><span class="line">PRINT <span class="variable">@stuName</span></span><br><span class="line">PRINT <span class="variable">@stuBirthday</span></span><br></pre></td></tr></table></div></figure>

<p>查询结果有多条时，只能接收一条！</p>

        <h3 id="全局变量"   >
          <a href="#全局变量" class="heading-link"><i class="fas fa-link"></i></a><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h3>
      <ul>
<li><p>由系统提供且预先声明的变量</p>
</li>
<li><p>用户只能引用</p>
</li>
<li><p>使用<code>@@</code></p>
</li>
<li><p>用户不能定义和全局变量同名的局部变量，否则报错</p>
</li>
<li><p>常用全局变量</p>
<ul>
<li>@@ERROR<ul>
<li>最后一个T-SQL错误的错误号</li>
</ul>
</li>
<li>@@IDENTITY<ul>
<li>最后一次插入的标识值</li>
</ul>
</li>
<li>@@LANGUAGE<ul>
<li>当前使用的语言的名称</li>
</ul>
</li>
<li>@@MAX_CONNECTIONS<ul>
<li>可以创建的同时连接的最大数目</li>
</ul>
</li>
<li>@@ROWCOUNT<ul>
<li>受上一个SQL语句影响的行数</li>
</ul>
</li>
<li>@@SERVERNAME<ul>
<li>本地服务器的名称</li>
</ul>
</li>
<li>@@TRANSCONUNT<ul>
<li>当前连接打开的事务数</li>
</ul>
</li>
<li>@@VERSION<ul>
<li>SQL Server的版本信息</li>
</ul>
</li>
</ul>
</li>
</ul>

        <h3 id="流程控制-IF"   >
          <a href="#流程控制-IF" class="heading-link"><i class="fas fa-link"></i></a><a href="#流程控制-IF" class="headerlink" title="流程控制-IF"></a>流程控制-IF</h3>
      <figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">IF 布尔表达式</span><br><span class="line">  <span class="keyword">BEGIN</span></span><br><span class="line">    语句<span class="number">1</span></span><br><span class="line">    语句<span class="number">2</span></span><br><span class="line">    ……</span><br><span class="line">  <span class="keyword">END</span></span><br><span class="line"><span class="keyword">ELSE</span></span><br><span class="line">  <span class="keyword">BEGIN</span></span><br><span class="line">    语句<span class="number">1</span></span><br><span class="line">    语句<span class="number">2</span></span><br><span class="line">    ……</span><br><span class="line">  <span class="keyword">END</span></span><br></pre></td></tr></table></div></figure>

<ul>
<li>允许嵌套</li>
<li>如果<code>BEGIN……END</code>中间只有一行程序，则可以省略<code>BEGIN</code>与<code>ENDS</code></li>
</ul>

        <h4 id="IF-EXISTS"   >
          <a href="#IF-EXISTS" class="heading-link"><i class="fas fa-link"></i></a><a href="#IF-EXISTS" class="headerlink" title="IF EXISTS"></a>IF EXISTS</h4>
      <p>存在数据时执行，加上<code>NOT</code>则相反：</p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">IF [<span class="keyword">NOT</span>] <span class="keyword">EXISTS</span> (<span class="keyword">SELECT</span>查询语句)</span><br><span class="line">  T<span class="operator">-</span><span class="keyword">SQL</span>语句<span class="operator">|</span>语句块</span><br><span class="line">[<span class="keyword">ELSE</span>]</span><br><span class="line">  T<span class="operator">-</span><span class="keyword">SQL</span>语句<span class="operator">|</span>语句块</span><br></pre></td></tr></table></div></figure>


        <h3 id="流程控制-CASE"   >
          <a href="#流程控制-CASE" class="heading-link"><i class="fas fa-link"></i></a><a href="#流程控制-CASE" class="headerlink" title="流程控制-CASE"></a>流程控制-CASE</h3>
      <ul>
<li>简单型</li>
<li>查找型</li>
</ul>
<p>前面记过了==、</p>

        <h3 id="流程控制-WHILE"   >
          <a href="#流程控制-WHILE" class="heading-link"><i class="fas fa-link"></i></a><a href="#流程控制-WHILE" class="headerlink" title="流程控制-WHILE"></a>流程控制-WHILE</h3>
      <figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">WHILE <span class="operator">&lt;</span>布尔表达式<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="operator">&lt;</span>T<span class="operator">-</span><span class="keyword">SQL</span>语句<span class="operator">|</span>语句块<span class="operator">&gt;</span></span><br><span class="line">  [BREAK]</span><br><span class="line">  [CONTINUE]</span><br><span class="line">  <span class="operator">&lt;</span>T<span class="operator">-</span><span class="keyword">SQL</span>语句<span class="operator">|</span>语句块<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></div></figure>


        <h3 id="存储过程概述"   >
          <a href="#存储过程概述" class="heading-link"><i class="fas fa-link"></i></a><a href="#存储过程概述" class="headerlink" title="存储过程概述"></a>存储过程概述</h3>
      <ul>
<li><p>优点</p>
<ul>
<li>执行速度更快——在数据库中保存的存储过程收拾编译过的</li>
<li>允许模块化程序设计——类的方法的复用</li>
<li>提高系统安全性——防止SQL注入</li>
<li>减少网络流量——只需传输存储过程的名称</li>
</ul>
</li>
<li><p>缺点</p>
<ul>
<li>增大了数据库压力</li>
</ul>
</li>
<li><p>存储过程分类</p>
<ul>
<li>系统存储过程<ul>
<li>由系统定义，存放在master数据库中</li>
<li>系统存储过程的名称都以<code>sp_</code>开头或<code>xp_</code>开头</li>
</ul>
</li>
<li>用户自定义存储过程<ul>
<li>由用户在自己的数据库中创建的存储过程</li>
</ul>
</li>
</ul>
</li>
<li><p>常用系统存储过程</p>
<ul>
<li>sp_databases<ul>
<li>列出服务器上的所有数据库</li>
</ul>
</li>
<li>sp_helpdb<ul>
<li>报告有关指定数据库或所有数据库的信息</li>
</ul>
</li>
<li>sp_renamedb<ul>
<li>更改数据库的名称</li>
</ul>
</li>
<li>sp_rename<ul>
<li>更改数据库的名称</li>
</ul>
</li>
<li>sp_tables<ul>
<li>返回当前环境下课查询的对象的列表</li>
</ul>
</li>
<li>sp_columns<ul>
<li>返回某个列的信息</li>
</ul>
</li>
<li>sp_help<ul>
<li>查看某个表的所有信息</li>
</ul>
</li>
<li>sp_helpconstraint<ul>
<li>查看某个表的约束</li>
</ul>
</li>
<li>sp_helpindex<ul>
<li>查看某个表的索引</li>
</ul>
</li>
<li>sp_stored_procedures<ul>
<li>列出当前环境中的所有存储过程</li>
</ul>
</li>
<li>sp_passwd<ul>
<li>添加或修改登录账户的密码</li>
</ul>
</li>
<li>sp_helptext<ul>
<li>显示默认值、未加密的存储过程、用户定义的存储过程、触发器或视图的实际文本</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>举个栗子：</p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXEC</span> sp_help student</span><br><span class="line"><span class="comment">--查看某个表的所有信息</span></span><br></pre></td></tr></table></div></figure>


        <h3 id="存储过程的创建和执行方法"   >
          <a href="#存储过程的创建和执行方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#存储过程的创建和执行方法" class="headerlink" title="存储过程的创建和执行方法"></a>存储过程的创建和执行方法</h3>
      
        <h4 id="创建存储过程语法"   >
          <a href="#创建存储过程语法" class="heading-link"><i class="fas fa-link"></i></a><a href="#创建存储过程语法" class="headerlink" title="创建存储过程语法"></a>创建存储过程语法</h4>
      <figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> PROC <span class="operator">|</span> <span class="keyword">PROCEDURE</span> 存储过程名</span><br><span class="line">[@参数名 数据类型 [<span class="operator">=</span><span class="keyword">default</span>] [OUTPUT]] [,……]</span><br><span class="line">[<span class="keyword">WITH</span> ENCRYPTION]</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="operator">&lt;</span><span class="keyword">SQL</span>语句<span class="operator">&gt;</span>[,……]</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></div></figure>

<ul>
<li>参数分为输入参数、输出参数两种，OUTPUT指示参数是输出参数</li>
<li>输入参数允许有默认值，DEFAULT设置参数的默认值</li>
<li><code>ENCRYPTION</code>：将<code>CREATE PROCEDURE</code>语句的原始文本加密</li>
<li>AS：指明该存储过程将要执行的动作</li>
</ul>

        <h4 id="执行存储过程"   >
          <a href="#执行存储过程" class="heading-link"><i class="fas fa-link"></i></a><a href="#执行存储过程" class="headerlink" title="执行存储过程"></a>执行存储过程</h4>
      <figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXEC</span> 存储过程名 [参数<span class="number">1</span>] [,参数<span class="number">2</span>] [,……]</span><br></pre></td></tr></table></div></figure>

<p>带有默认值的存储过程同C++语法</p>
<ul>
<li>带有输出参数的存储过程<ul>
<li><code>EXEC 存储过程名 变量名 OUTPUT</code></li>
</ul>
</li>
</ul>

        <h1 id="第五课"   >
          <a href="#第五课" class="heading-link"><i class="fas fa-link"></i></a><a href="#第五课" class="headerlink" title="第五课"></a>第五课</h1>
      <blockquote>
<p>放假休息</p>
</blockquote>

        <h1 id="第六课"   >
          <a href="#第六课" class="heading-link"><i class="fas fa-link"></i></a><a href="#第六课" class="headerlink" title="第六课"></a>第六课</h1>
      
        <h2 id="复习"   >
          <a href="#复习" class="heading-link"><i class="fas fa-link"></i></a><a href="#复习" class="headerlink" title="复习"></a>复习</h2>
      
        <h3 id="带有EXISTS谓词的子查询"   >
          <a href="#带有EXISTS谓词的子查询" class="heading-link"><i class="fas fa-link"></i></a><a href="#带有EXISTS谓词的子查询" class="headerlink" title="带有EXISTS谓词的子查询"></a>带有EXISTS谓词的子查询</h3>
      <p>查询所有选修了Dp010001号课的学生姓名</p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> StudentName</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">EXISTS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">  <span class="keyword">FROM</span> GRADE</span><br><span class="line">  <span class="keyword">WHERE</span> Student.StudentID <span class="operator">=</span> Grade.StudentID</span><br><span class="line">  <span class="keyword">AND</span> CourseID <span class="operator">=</span> <span class="string">&#x27;Dp010001&#x27;</span></span><br><span class="line">)</span><br></pre></td></tr></table></div></figure>


        <h2 id="数据类型"   >
          <a href="#数据类型" class="heading-link"><i class="fas fa-link"></i></a><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2>
      <ul>
<li><p>char类型指定了长度不够会自动补全</p>
</li>
<li><p>varchar类型指定了长度不够会释放内存</p>
</li>
<li><p>date</p>
<ul>
<li>日期</li>
</ul>
</li>
<li><p>time</p>
<ul>
<li>时间</li>
</ul>
</li>
<li><p>datetime</p>
<ul>
<li>日期和时间</li>
</ul>
</li>
<li><p>unique允许一行为null</p>
</li>
</ul>

        <h2 id="网课-4"   >
          <a href="#网课-4" class="heading-link"><i class="fas fa-link"></i></a><a href="#网课-4" class="headerlink" title="网课"></a>网课</h2>
      
        <h3 id="自定义函数-标量函数"   >
          <a href="#自定义函数-标量函数" class="heading-link"><i class="fas fa-link"></i></a><a href="#自定义函数-标量函数" class="headerlink" title="自定义函数-标量函数"></a>自定义函数-标量函数</h3>
      <ul>
<li>内置系统函数<ul>
<li>聚合函数</li>
<li>日期和时间函数</li>
<li>数学函数</li>
<li>字符串函数</li>
</ul>
</li>
<li>用户自定义函数<ul>
<li>标量函数<ul>
<li>返回的是一个单值，可以在select和where子句进行函数调用</li>
</ul>
</li>
<li>表值函数<ul>
<li>返回table数据类型，只能在select子句的from子句中调用</li>
<li>内嵌表值函数</li>
<li>多语句表值函数</li>
</ul>
</li>
</ul>
</li>
</ul>

        <h4 id="标量函数创建的语法"   >
          <a href="#标量函数创建的语法" class="heading-link"><i class="fas fa-link"></i></a><a href="#标量函数创建的语法" class="headerlink" title="标量函数创建的语法"></a>标量函数创建的语法</h4>
      <figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> 函数名</span><br><span class="line">  (@参数名 参数数据类型[<span class="operator">=</span><span class="keyword">default</span>][,……n])</span><br><span class="line">  <span class="keyword">RETURNS</span> 返回值数据类型</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">  <span class="keyword">BEGIN</span></span><br><span class="line">    T<span class="operator">-</span><span class="keyword">SQL</span>语句</span><br><span class="line">    <span class="keyword">RETURN</span> 表达式</span><br><span class="line">  <span class="keyword">END</span></span><br></pre></td></tr></table></div></figure>

<ol>
<li>只能是输入参数，不能有输出参数，所有的输入参数前都必须加<code>@</code></li>
<li><code>create</code>后的返回，单词是<code>returns</code>，而不是<code>return</code></li>
<li><code>returns</code>后面跟的不是变量，而是返回值的类型，如：<code>int</code>,<code>char</code>等</li>
<li>在<code>begin/end</code>语句块中，是<code>return</code></li>
</ol>
<ul>
<li>创建函数<code>get_sname()</code>,通过学号返回姓名，并利用该函数查询选修成绩不及格学生的姓名。</li>
</ul>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> get_sname(<span class="variable">@stuNO</span> <span class="type">char</span>(<span class="number">12</span>))</span><br><span class="line"><span class="keyword">RETURNS</span> <span class="type">char</span>(<span class="number">8</span>)</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> <span class="variable">@sname</span> <span class="type">char</span>(<span class="number">8</span>)</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="variable">@sname</span><span class="operator">=</span>StudentName <span class="keyword">from</span> student</span><br><span class="line">    <span class="keyword">WHERE</span> StudentID<span class="operator">=</span><span class="variable">@stuNo</span></span><br><span class="line">  <span class="keyword">RETURN</span> <span class="variable">@sname</span></span><br><span class="line"><span class="keyword">END</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--调用函数</span></span><br><span class="line"><span class="keyword">SELECT</span> dbo.get_sname(StudentID) <span class="keyword">AS</span> 姓名 <span class="keyword">FROM</span> Grade <span class="keyword">WHERE</span> Grade<span class="operator">&lt;</span><span class="number">60</span></span><br></pre></td></tr></table></div></figure>


        <h4 id="创建内嵌表值函数"   >
          <a href="#创建内嵌表值函数" class="heading-link"><i class="fas fa-link"></i></a><a href="#创建内嵌表值函数" class="headerlink" title="创建内嵌表值函数"></a>创建内嵌表值函数</h4>
      <ul>
<li>内嵌表值函数创建的语法</li>
</ul>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> 函数名(@参数名 参数数据类型[,……n])</span><br><span class="line"><span class="keyword">RETURNS</span> <span class="keyword">TABLE</span></span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">  <span class="keyword">RETURN</span>(T<span class="operator">-</span><span class="keyword">SQL</span>语句)</span><br></pre></td></tr></table></div></figure>

<ol>
<li>只能返回<code>table</code>，所以<code>returns</code>后面一定是<code>TABLE</code></li>
<li><code>AS</code>后没有<code>begin/end</code>，只有一个<code>return</code>语句来返回特定的记录。</li>
</ol>
<ul>
<li>创建一个自定义内嵌表值函数<code>getStuInfo</code>，返回指定班级的学生的学号，姓名，性别，班级名称。</li>
</ul>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> getStuInfo(<span class="variable">@classNo</span> <span class="type">CHAR</span>(<span class="number">8</span>))</span><br><span class="line"><span class="keyword">RETURNS</span> <span class="keyword">TABLE</span></span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">RETURN</span>(<span class="keyword">SELECT</span> StudentID,StudentName,Sex,ClassName</span><br><span class="line">  <span class="keyword">FROM</span> Student,Class</span><br><span class="line">  <span class="keyword">WHERE</span> Class.ClassID<span class="operator">=</span><span class="variable">@classNo</span></span><br><span class="line">  <span class="keyword">AND</span> Student.ClassID<span class="operator">=</span>Class.ClassID</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">--调用方式</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dbo.getStuInfo(<span class="string">&#x27;Cs010902&#x27;</span>)</span><br></pre></td></tr></table></div></figure>


        <h3 id="触发器"   >
          <a href="#触发器" class="heading-link"><i class="fas fa-link"></i></a><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h3>
      
        <h4 id="触发器的概念"   >
          <a href="#触发器的概念" class="heading-link"><i class="fas fa-link"></i></a><a href="#触发器的概念" class="headerlink" title="触发器的概念"></a>触发器的概念</h4>
      <p>触发器是一段由对数据的更改操作引发的自动执行的代码。通常用于保证业务规则和数据完整性，其主要优点是用户可以用编程的方式来实现复杂的处理逻辑和业务规则，增强了数据完整性约束的功能。</p>
<ul>
<li><p>触发器的分类</p>
<ul>
<li>DML触发器<ul>
<li>当数据库服务器中发生<strong>数据操作语言事件</strong>，如<code>INSERT``ALTER``UPDATE</code>等操作触发的触发器。</li>
<li>后触发器 AFTER触发器<ul>
<li>操作完成后再被激活执行触发器里的SQL语句</li>
</ul>
</li>
<li>前触发器 INSTEAD OF触发器<ul>
<li>对记录的操作进行之前就被激活，执行触发器中的SQL语句，而不再执行原来的SQL操作。</li>
</ul>
</li>
<li>当触发器触发时，系统自动在内存中创建<code>deleted</code>表或<code>inserted</code>表，这两个表的结构同建立触发器的结构完全相同，这两张表是只读的，不允许修改，触发器执行完成后自动删除</li>
</ul>
</li>
<li>DDL触发器<ul>
<li>当数据库服务器中发生<strong>数据定义语言事件</strong>，如<code>CREATE``ALTER``DROP</code>等操作出发的触发器</li>
</ul>
</li>
</ul>
</li>
<li><p>创建DML触发器</p>
<ul>
<li>触发器名称要符合命名规范，且必须唯一</li>
<li>FOR和AFTER均表示后触发器，INSTEAD OF表示前触发器</li>
<li>DELETE,INSERT和UPDATE表示引发触发器执行的操作，如果同时指定多个操作，各个操作用逗号分隔</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> 触发器名称</span><br><span class="line"><span class="keyword">ON</span> 表名</span><br><span class="line">&#123;<span class="keyword">FOR</span><span class="operator">|</span>AFTER<span class="operator">|</span>INSTEAD <span class="keyword">OF</span>&#125;</span><br><span class="line">&#123;[<span class="keyword">DELETE</span>][,][<span class="keyword">INSERT</span>][,][UPDATE]&#125;</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">  <span class="keyword">SQL</span>语句<span class="operator">|</span>语句块</span><br></pre></td></tr></table></div></figure>


        <h4 id="后触发器"   >
          <a href="#后触发器" class="heading-link"><i class="fas fa-link"></i></a><a href="#后触发器" class="headerlink" title="后触发器"></a>后触发器</h4>
      <figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> tri_After</span><br><span class="line"><span class="keyword">ON</span> Class AFTER <span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">  <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Class</span><br><span class="line">  <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> inserted</span><br></pre></td></tr></table></div></figure>

<ul>
<li>在Grade表上创建一个后触发器，当成绩字段修改或新数据插入后触发，检查分数是否在0-100之间。</li>
</ul>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> tri_grade</span><br><span class="line"><span class="keyword">ON</span> Grade</span><br><span class="line">AFTER <span class="keyword">INSERT</span>, UPDATE</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">  IF <span class="keyword">EXISTS</span>(<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> inserted <span class="keyword">WHERE</span> grade<span class="operator">&lt;</span><span class="number">0</span> <span class="keyword">OR</span> grade<span class="operator">&gt;</span><span class="number">100</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  PRINT<span class="string">&#x27;输入的分数应该在0-100之间，请确认输入的考试分数！&#x27;</span></span><br><span class="line">  <span class="keyword">ROLLBACK</span></span><br><span class="line"><span class="keyword">END</span></span><br><span class="line"><span class="keyword">ELSE</span></span><br><span class="line">  PRINT<span class="string">&#x27;修改成功！&#x27;</span></span><br></pre></td></tr></table></div></figure>


        <h4 id="前触发器"   >
          <a href="#前触发器" class="heading-link"><i class="fas fa-link"></i></a><a href="#前触发器" class="headerlink" title="前触发器"></a>前触发器</h4>
      <p><code>INSTEAD OF</code>触发器是在对记录的操作进行之前就被激活，执行触发器中的SQL语句，而<strong>不再执行原来的SQL操作</strong>。</p>
<ul>
<li>在student表上创建一个前触发器，在录入学生信息时，限制班级人数不能超过10人。</li>
</ul>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> tri_Instead2</span><br><span class="line"><span class="keyword">ON</span> student</span><br><span class="line">INSTEAD <span class="keyword">OF</span> <span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">  <span class="keyword">DECLARE</span> <span class="variable">@classno</span> <span class="type">char</span>(<span class="number">8</span>)</span><br><span class="line">  <span class="keyword">SELECT</span> <span class="variable">@classno</span><span class="operator">=</span>ClassID</span><br><span class="line">  <span class="keyword">FROM</span> inserted</span><br><span class="line">  IF(<span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> STUDENT <span class="keyword">WHERE</span> ClassID<span class="operator">=</span><span class="variable">@classno</span>)<span class="operator">&lt;</span><span class="number">10</span></span><br><span class="line">  <span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">INSERT</span> <span class="keyword">INTO</span> student <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> inserted</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Student <span class="keyword">WHERE</span> ClassID<span class="operator">=</span><span class="variable">@classno</span></span><br><span class="line">  <span class="keyword">END</span></span><br><span class="line"><span class="keyword">ELSE</span></span><br><span class="line">  PRINT<span class="string">&#x27;班级人数已满&#x27;</span></span><br></pre></td></tr></table></div></figure>


        <h3 id="安全管理"   >
          <a href="#安全管理" class="heading-link"><i class="fas fa-link"></i></a><a href="#安全管理" class="headerlink" title="安全管理"></a>安全管理</h3>
      <ol>
<li>身份验证</li>
<li>操作权控制</li>
<li>文件操作控制</li>
<li>加密存储与冗余</li>
</ol>
<ul>
<li><p>登录账户来源</p>
<ul>
<li>Windows授权用户</li>
<li>SQL Server授权用户</li>
</ul>
</li>
<li><p>安全认证模式</p>
<ul>
<li>Windows身份验证模式</li>
<li>混合身份验证模式</li>
</ul>
</li>
<li><p>SQL Server登录账户</p>
<ul>
<li>SQL Server的安全权限是基于用户登录标识符的，没有有效的登录ID，用户无法连接数据库服务器</li>
<li>SQL Server身份验证登录，默认的登录名是sa，拥有系统管理员权限</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--使用SQL语句创建登录账号</span></span><br><span class="line"><span class="keyword">CREATE</span> LOGIN SQL_USERNAME </span><br><span class="line"><span class="keyword">WITH</span> PASSWORD<span class="operator">=</span><span class="string">&#x27;XXXXXX&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">---删除登录账号</span></span><br><span class="line"><span class="keyword">DROP</span> LOGIN login_name</span><br><span class="line"><span class="comment">--不能删除正在使用的登录用户，也不能删除拥有任何数据库和服务器级别对象的登录用户</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--为某一数据库创建用户</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> SQL_USERNAME</span><br><span class="line"></span><br><span class="line"><span class="comment">--删除用户</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> USER_NAME</span><br><span class="line"><span class="comment">--不能删除拥有对象的用户</span></span><br><span class="line"><span class="comment">--用户的删除，不影响登录账号的存在，反过来也一样</span></span><br></pre></td></tr></table></div></figure>

<ul>
<li><p>登录账户和数据库用户的关系</p>
<ul>
<li>一个登录账号可以映射为多个数据库用户，但一个登录名在每个数据库中只能映射一次</li>
</ul>
</li>
<li><p>对象管理权限</p>
<ul>
<li>用户创建和管理数据库中表、视图等对象的权限</li>
<li>CREATE DATABASE</li>
<li>CREATE TABLE</li>
<li>CREATE VIEW</li>
<li>CREATE PROCEDURE</li>
<li>BACKUP DATABASE</li>
<li>BACKUP LOG</li>
</ul>
</li>
<li><p>数据操作权限</p>
<ul>
<li>对数据库中表、视图中的数据进行查询、增加、删除和修改的权限</li>
<li>INSERT</li>
<li>DELETE</li>
<li>UPDATE</li>
<li>SELECT</li>
<li>EXECUTE</li>
</ul>
</li>
<li><p>隐含权限</p>
<ul>
<li>内置权限，不需要再明确地授予这些权限</li>
</ul>
</li>
<li><p>权限的管理</p>
<ul>
<li>授予权限<ul>
<li>授予用户或角色具有某种操作权</li>
</ul>
</li>
<li>收回权限<ul>
<li>收回(或撤销)曾经授予给用户或角色的权限</li>
</ul>
</li>
<li>拒绝权限<ul>
<li>拒绝某用户或角色具有某种操作权限。一旦拒绝了用户的某个权限，则用户从任何地方都不能获得该权限</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--授权语句</span></span><br><span class="line"><span class="keyword">GRANT</span> 权限名[,……]</span><br><span class="line">  <span class="keyword">TO</span>&#123;数据库用户名<span class="operator">|</span>用户角色名&#125;[,……]</span><br><span class="line"></span><br><span class="line"><span class="comment">--收权语句</span></span><br><span class="line"><span class="keyword">REVOKE</span> 权限名[,……]</span><br><span class="line">  <span class="keyword">FROM</span>&#123;数据库用户名<span class="operator">|</span>用户角色名&#125;[,……]</span><br><span class="line"></span><br><span class="line"><span class="comment">--拒绝语句</span></span><br><span class="line">DENY 权限名[,……]</span><br><span class="line">  <span class="keyword">TO</span>&#123;数据库用户名<span class="operator">|</span>用户角色名&#125;[,……]</span><br></pre></td></tr></table></div></figure>

<ul>
<li>角色<ul>
<li>为便于对角色及权限的管理，可以将一组具有相同权限的用户组织在一起，这一组具有相同权限的用户就称为<strong>角色</strong>。</li>
<li>3类<ul>
<li>固定的服务器角色<ul>
<li>bulkadmin<ul>
<li>具有执行BULK,INSERT语句的权限</li>
</ul>
</li>
<li>dbcreator<ul>
<li>具有创建数据库的权限</li>
</ul>
</li>
<li>diskadmin<ul>
<li>具有管理磁盘资源的权限</li>
</ul>
</li>
<li>processadmin<ul>
<li>具有管理全部的连接以及服务器状态的权限</li>
</ul>
</li>
<li>securityadmin<ul>
<li>具有管理服务器登录账户的权限</li>
</ul>
</li>
<li>serveradmin<ul>
<li>具有全部配置服务器范围的设置</li>
</ul>
</li>
<li>setupadmin<ul>
<li>具有更改任何链接服务器的权限</li>
</ul>
</li>
<li>sysadmin<ul>
<li>系统管理员角色，具有服务器及数据库上的全部权限</li>
</ul>
</li>
<li>public<ul>
<li>每个登录账户自动拥有，不能对其进行授权</li>
</ul>
</li>
</ul>
</li>
<li>固定的数据库角色<ul>
<li>db_accessadmin<ul>
<li>具有添加或删除数据库用户的权限</li>
</ul>
</li>
<li>db_backupoperator<ul>
<li>具有备份数据库、日志的权限</li>
</ul>
</li>
<li>db_datareader<ul>
<li>具有查询数据库中所有用户表数据的权限</li>
</ul>
</li>
<li>db_datawriter<ul>
<li>具有更改数据库中所有用户表数据的权限</li>
</ul>
</li>
<li>db_ddladmin<ul>
<li>具有建立、修改和删除数据库对象的权限</li>
</ul>
</li>
<li>db_denydatareader<ul>
<li>不允许具有查询数据库中所有用户表数据的权限</li>
</ul>
</li>
<li>db_denydatawriter<ul>
<li>不允许具有更改数据库中所有用户表数据的权限</li>
</ul>
</li>
<li>db_owner<ul>
<li>具有数据库中的全部操作权限</li>
</ul>
</li>
<li>db_securityadmin<ul>
<li>具有管理数据库角色和角色成员以及数据库中的对象管理和数据操作的全部权限</li>
</ul>
</li>
</ul>
</li>
<li>用户自定义的角色<ul>
<li>用户自定义的角色属于数据库级别的角色</li>
<li>用户的成员可以是数据库的角色，也可以是用户定义的角色</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--在固定的服务器角色中添加成员用系统存储过程sp_addsrvrolemember:</span></span><br><span class="line">sp_addsrvrolemember 登录名,角色名</span><br><span class="line"></span><br><span class="line"><span class="comment">--在固定的服务器角色中删除成员用系统存储过程sp_dropsrvrolemember:</span></span><br><span class="line">sp_dropsrvrolemember 登录名,角色名</span><br></pre></td></tr></table></div></figure>

<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--创建新角色的语法</span></span><br><span class="line"><span class="keyword">CREATE</span> ROLE 新角色名 [<span class="keyword">AUTHORIZATION</span>拥有者]</span><br><span class="line"><span class="comment">--新角色没有权限，要进行授权</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--删除</span></span><br><span class="line"><span class="keyword">DROP</span> ROLE 名字</span><br><span class="line"><span class="comment">--不能删除拥有安全对象的角色</span></span><br><span class="line"><span class="comment">--不能从数据库中删除拥有成员的角色</span></span><br><span class="line"><span class="comment">--不能删除固定的数据库角色</span></span><br></pre></td></tr></table></div></figure>


        <h2 id="网课-5"   >
          <a href="#网课-5" class="heading-link"><i class="fas fa-link"></i></a><a href="#网课-5" class="headerlink" title="网课"></a>网课</h2>
      
        <h3 id="备份和恢复数据库"   >
          <a href="#备份和恢复数据库" class="heading-link"><i class="fas fa-link"></i></a><a href="#备份和恢复数据库" class="headerlink" title="备份和恢复数据库"></a>备份和恢复数据库</h3>
      
        <h4 id="数据故障"   >
          <a href="#数据故障" class="heading-link"><i class="fas fa-link"></i></a><a href="#数据故障" class="headerlink" title="数据故障"></a>数据故障</h4>
      <ul>
<li><p>系统故障</p>
<ul>
<li>造成系统停止运转的任何事件，是的系统要重新启动。</li>
<li>特定类型的硬件错误(如CPU故障)</li>
<li>操作系统故障</li>
<li>数据库管理系统代码错误</li>
<li>系统断电</li>
</ul>
</li>
<li><p>事务故障</p>
<ul>
<li>某事物在未运行至正常终止点就夭折了，可以分为可预期的和不可预期的两类。<ul>
<li>可预期的事物故障：取款余额不足，买票以售完等。</li>
<li>非预期的事物故障：运算溢出、并发事物发生死锁等。</li>
</ul>
</li>
</ul>
</li>
<li><p>介质故障</p>
<ul>
<li>磁盘损坏</li>
<li>磁头碰撞</li>
<li>瞬时强磁场干扰</li>
<li>介质故障比前两类故障的可能性小得多，但破坏性大得多</li>
</ul>
</li>
<li><p>故障影响</p>
<ul>
<li>数据库本身被破坏，需要通过备份的数据库还原数据库。</li>
<li>数据库没有被破坏，但数据可能不正确，可以通过日志文件恢复。</li>
</ul>
</li>
</ul>

        <h4 id="备份数据库"   >
          <a href="#备份数据库" class="heading-link"><i class="fas fa-link"></i></a><a href="#备份数据库" class="headerlink" title="备份数据库"></a>备份数据库</h4>
      <ul>
<li><p>数据库的安全性和可靠性必不可少，为了保障数据库的正常运行，就必须做好数据库备份。</p>
</li>
<li><p>备份数据库就是将<strong>数据库中的数据</strong>和<strong>保证数据库系统正常运行的相关信息</strong>保存起来，以备系统出现问题时，恢复数据库时使用。</p>
</li>
<li><p>备份内容</p>
<ul>
<li>系统数据库</li>
<li>用户数据库</li>
</ul>
</li>
<li><p>备份时间</p>
<ul>
<li>系统数据库：变化频率低，修改之后备份</li>
<li>用户数据库：周期性备份，备份周期由用户需求决定，时间点选在数据操作少的时候进行。</li>
</ul>
</li>
</ul>

        <h4 id="备份策略"   >
          <a href="#备份策略" class="heading-link"><i class="fas fa-link"></i></a><a href="#备份策略" class="headerlink" title="备份策略"></a>备份策略</h4>
      <ul>
<li><p>备份策略</p>
<ul>
<li>备份策略的制定<ul>
<li>确定备份类型</li>
<li>频率</li>
<li>备份所需硬件特征和速度</li>
<li>备份的测试方法</li>
<li>备份所存放的位置</li>
</ul>
</li>
<li>考虑的因素<ul>
<li>业务需求</li>
<li>数据库特征</li>
<li>对资源的约束</li>
</ul>
</li>
</ul>
</li>
<li><p>策略1：完整备份</p>
<ul>
<li>适合于数据库数据不是很大，而且数据更改不是很频繁地情况，会丢失部分数据。</li>
</ul>
</li>
<li><p>策略2：完整备份+事务日志备份</p>
<ul>
<li>不希望经常地进行完成备份，则可以在完整备份中间加一些日志备份。</li>
</ul>
</li>
<li><p>策略3：完整备份+差异备份+事务日志备份</p>
<ul>
<li>优点是备份和恢复的速度都比较快，而且当系统出现故障时，丢失的数据也比较少。</li>
</ul>
</li>
</ul>

        <h4 id="SQL-Server的备份机制"   >
          <a href="#SQL-Server的备份机制" class="heading-link"><i class="fas fa-link"></i></a><a href="#SQL-Server的备份机制" class="headerlink" title="SQL Server的备份机制"></a>SQL Server的备份机制</h4>
      <ul>
<li><p>备份设备</p>
</li>
<li><p>恢复模式</p>
</li>
<li><p>备份类型</p>
</li>
<li><p>实现备份</p>
</li>
<li><p>备份设备</p>
<ul>
<li>SQL Server中备份数据库的场所被称为备份设备，逻辑备份设备是指数据库备份的逻辑名，物理备份设备是操作系统上数据文件。</li>
<li>备份设备可以分为：<ul>
<li><strong>永久备份设备</strong>需要在备份之前需要预先建立。</li>
<li><strong>临时备份设备</strong>不需要预先建立，在备份时直接使用。</li>
</ul>
</li>
</ul>
</li>
<li><p>创建备份设备</p>
<ul>
<li>创建备份设备可以使用系统存储过程<code>sp_addumpdevice</code>。<ul>
<li>语法规则:<code>sp_addumpdevice 备份数倍类型,逻辑名,物理文件名</code></li>
</ul>
</li>
<li>例如建立一个名为bk2的此版备份设备，物理存储位置以及文件名为：<code>D:\dump\bk.bak</code><ul>
<li><code>sp_addumpdevice &#39;disk&#39;,&#39;bk2&#39;,&#39;D:\dump\bk2.bak&#39;</code></li>
</ul>
</li>
</ul>
</li>
<li><p>恢复模式</p>
<ul>
<li>简单恢复<ul>
<li>不备份事物日志</li>
<li>丢失风险高</li>
<li>适用于测试开发</li>
</ul>
</li>
<li>完整恢复<ul>
<li>完整记录事务</li>
<li>可恢复到故障点</li>
<li>适用于实际应用</li>
</ul>
</li>
<li>大容量日志<ul>
<li>记录大容量操作</li>
<li>有一定风险</li>
<li>作为完整恢复模式的附加模式</li>
</ul>
</li>
</ul>
</li>
<li><p>备份类型</p>
<ul>
<li>数据库的恢复模式决定了可以使用的备份类型，数据库备份类型决定所备份的内容。</li>
<li>SQL Server中的备份类型包括：<ul>
<li>数据库备份(完整备份和差异备份)</li>
<li>文件备份</li>
<li>事务日志备份</li>
</ul>
</li>
<li>文件备份可使用分离和附加数据库的功能</li>
</ul>
</li>
<li><p>数据库备份</p>
<ul>
<li>完整备份<ul>
<li>完整数据库备份是所有备份方法中最基本也是最重要的备份，也是差异备份的基准。</li>
<li>备份数据库中的全部信息，包括数据文件、日志文件，文件存储的位置信息以及数据库全部对象。</li>
<li>消耗较长时间和资源，但不影响用户使用。</li>
</ul>
</li>
<li>差异备份<ul>
<li>差异备份以前一次完整备份为基准点(差异基准)，备份从上次完整备份之后数据库的全部变化内容。</li>
<li>差异备份通常速度快，耗时短，但较为复杂。差异备份的时间和大小取决于自建立差异基准后更改的数据量。通常，差异基准越旧，新的差异备份就越大。</li>
</ul>
</li>
<li>事务日志备份<ul>
<li>事务日志备份，不备份数据库本身，它只备份日志记录，而且只备份从上次备份之后到当前备份时间发生变化的日志内容。</li>
<li>可将数据库恢复到故障点或特定的某个时间点。</li>
<li>比完整备份和差异备份使用的资源少，但只能在完整恢复模式和大容量日志恢复模式下使用。</li>
</ul>
</li>
</ul>
</li>
<li><p>SQL语句备份数据库</p>
</li>
</ul>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BACKUP DATABASE 数据库名</span><br><span class="line"><span class="keyword">TO</span> 备份设备名[<span class="keyword">WITH</span> [DIFFERENTIAL][[,]&#123;INIT<span class="operator">|</span>NOINIT&#125;]]</span><br></pre></td></tr></table></div></figure>

<ul>
<li><p>DIFFERENTIAL:差异备份</p>
</li>
<li><p>INIT:本次备份将重写备份设备</p>
</li>
<li><p>NOINIT:本次备份将追加到备份设备。默认项</p>
</li>
<li><p>SQL语句备份事务日志</p>
</li>
</ul>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BACKUP LOG 数据库名 <span class="keyword">TO</span>&#123;<span class="operator">&lt;</span>备份设备名<span class="operator">&gt;</span>&#125;</span><br><span class="line">[<span class="keyword">WITH</span> [&#123;INIT<span class="operator">|</span>NOINIT&#125;],NORECOVERY][&#123;[,]NO_LOG<span class="operator">|</span>TRUNCATE_ONLY<span class="operator">|</span>NO_TRUNCATE&#125;]</span><br></pre></td></tr></table></div></figure>

<ul>
<li>NORECOVERY:尾部日志</li>
<li>NO_LOG|TRUNCATE_ONLY:截断日志</li>
<li>NO_TRUNCATE:不截断日志</li>
</ul>

        <h4 id="恢复数据库"   >
          <a href="#恢复数据库" class="heading-link"><i class="fas fa-link"></i></a><a href="#恢复数据库" class="headerlink" title="恢复数据库"></a>恢复数据库</h4>
      <ul>
<li><p>如果数据库没有毁坏，则应先对数据库的访问进行一些必要的限制。因为<strong>在恢复数据库的过程中，不允许用户操作数据库</strong>。</p>
</li>
<li><p>如果数据库的日志文件没有损坏，则为尽可能减少数据丢失，<strong>可在恢复之前对数据库进行一次尾部日志备份</strong>。</p>
</li>
<li><p>恢复数据库的顺序</p>
<ol>
<li>最近的完整数据库备份</li>
<li>最近的差异数据库备份</li>
<li>按备份顺序还原日志</li>
</ol>
</li>
<li><p>SQL语句恢复数据库</p>
</li>
</ul>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RESTORE DATABASE 数据库名</span><br><span class="line"><span class="keyword">FROM</span> 备份设备名</span><br><span class="line">[<span class="keyword">WITH</span> FILE <span class="operator">=</span> 文件号,NORECOVERY<span class="operator">|</span>RECOVERY]</span><br></pre></td></tr></table></div></figure>

<ul>
<li><p>FILE = 文件号：标识要还原的备份，文件号为1标识备份设备上的第一个备份</p>
</li>
<li><p>NORECOVERY：表明对数据库的恢复还没有完成</p>
</li>
<li><p>RECOVERY：表明对数据库的恢复已经完成</p>
</li>
<li><p>SQL语句还原事务日志</p>
</li>
</ul>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RESTORE LOG 数据库名</span><br><span class="line"><span class="keyword">FROM</span> 备份设备名</span><br><span class="line">[<span class="keyword">WITH</span> FILE <span class="operator">=</span> 文件号,NORECOVERY<span class="operator">|</span>RECOVERY]</span><br></pre></td></tr></table></div></figure>

<ul>
<li>参数含义和上面那个一样的</li>
</ul>

        <h2 id="网课第九单元"   >
          <a href="#网课第九单元" class="heading-link"><i class="fas fa-link"></i></a><a href="#网课第九单元" class="headerlink" title="网课第九单元"></a>网课第九单元</h2>
      
        <h3 id="9-1-数据模型"   >
          <a href="#9-1-数据模型" class="heading-link"><i class="fas fa-link"></i></a><a href="#9-1-数据模型" class="headerlink" title="9.1 数据模型"></a>9.1 数据模型</h3>
      <ul>
<li><p>实体</p>
<ul>
<li>实体名</li>
<li>属性<ul>
<li>取值不可为空的属性，强制的<code>*</code>标注</li>
<li>取值可以为空的属性，可选的<code>o</code>标注</li>
</ul>
</li>
</ul>
</li>
<li><p>实例</p>
<ul>
<li>实体中每个属性赋予具体的值，形成实例</li>
</ul>
</li>
<li><p>唯一标识符(UID)</p>
<ul>
<li>对于所有实例，取值各不相同(唯一)的属性集，称为唯一标识符，用<code>#</code>标注</li>
<li>每个实体有且仅有一个UID</li>
<li>UID并非总是属性，也可为属性集</li>
</ul>
</li>
<li><p>ER模型：</p>
<ul>
<li>描述世界的数据模型称为概念模型</li>
<li>ER模型为最常用的概念模型</li>
</ul>
</li>
</ul>

        <h3 id="9-2-联系"   >
          <a href="#9-2-联系" class="heading-link"><i class="fas fa-link"></i></a><a href="#9-2-联系" class="headerlink" title="9.2 联系"></a>9.2 联系</h3>
      <ul>
<li><p>联系</p>
<ul>
<li>实体与实体之间的关联，用联系来表示</li>
<li>联系描述实体之间的对应关系</li>
<li>一对一比较常见</li>
<li>其实就是函数的映射关系</li>
</ul>
</li>
<li><p>阅读规则</p>
<ul>
<li>每个</li>
<li>实体A</li>
<li>必须/可以(实体A一侧的线为实线/虚线)</li>
<li>联系动词(实体A一侧的联系动词)</li>
<li>一个或多个/一个且仅有一个(实体A对侧的线 鸡爪线/单线)</li>
<li>实体B</li>
</ul>
</li>
</ul>

        <h3 id="9-3-多对多"   >
          <a href="#9-3-多对多" class="heading-link"><i class="fas fa-link"></i></a><a href="#9-3-多对多" class="headerlink" title="9.3 多对多"></a>9.3 多对多</h3>
      
        <h3 id="9-4-关系数据库的基本概念"   >
          <a href="#9-4-关系数据库的基本概念" class="heading-link"><i class="fas fa-link"></i></a><a href="#9-4-关系数据库的基本概念" class="headerlink" title="9.4 关系数据库的基本概念"></a>9.4 关系数据库的基本概念</h3>
      <ul>
<li><p>笛卡尔积</p>
</li>
<li><p>关系</p>
<ul>
<li>就是二维表，满足如下性质：<ul>
<li>关系表中的每一列都是不可再分的基本属性</li>
<li>表中个属性不能重名</li>
<li>表中的行、列次序并不重要</li>
</ul>
</li>
</ul>
</li>
<li><p>属性</p>
<ul>
<li>二维表中的每个列称为一个属性(或叫字段)</li>
<li>每个属性有一个名字，称为<strong>属性名</strong>。</li>
<li>二维表中对应某一列的值称为<strong>属性值</strong>。</li>
</ul>
</li>
<li><p>二维表中列的个数称为关系的<strong>元数</strong>。如果一个二维表有n个列，则称其为<strong>n元关系</strong>。</p>
</li>
<li><p>关系数据库：对应于一个关系模型的所有关系的集合称为关系数据库。</p>
</li>
<li><p>候选码：如果一个属性或属性集的值能够唯一标识一个关系的元组而又不包含多余的属性，则称该属性或属性集为候选码</p>
<ul>
<li>候选码也称为候选键或候选关键字</li>
<li>在一个关系上可以有多个候选码</li>
</ul>
</li>
<li><p>主码</p>
<ul>
<li>当一个关系中有多个候选码时，可以从中选择一个作为主码</li>
<li>每个关系只能有一个主码</li>
<li>主码也称为逐渐或主关键字，用于唯一确定一个元组</li>
<li>主码可以由一个属性组成，也可以由多个属性共同组成</li>
</ul>
</li>
<li><p>主属性和非主属性</p>
<ul>
<li>包含在任一候选码中的属性称为主属性</li>
<li>不包含在任一候选码中的属性称为非主属性</li>
</ul>
</li>
</ul>

        <h3 id="9-5-函数依赖"   >
          <a href="#9-5-函数依赖" class="heading-link"><i class="fas fa-link"></i></a><a href="#9-5-函数依赖" class="headerlink" title="9.5 函数依赖"></a>9.5 函数依赖</h3>
      
        <h3 id="9-6-关系规范化"   >
          <a href="#9-6-关系规范化" class="heading-link"><i class="fas fa-link"></i></a><a href="#9-6-关系规范化" class="headerlink" title="9.6 关系规范化"></a>9.6 关系规范化</h3>
      <ul>
<li>数据冗余问题</li>
<li>异常<ul>
<li>更新异常(Update Anomalies)</li>
<li>插入异常(Insert Anomalies)</li>
<li>删除异常(Delete Anomalies)</li>
</ul>
</li>
<li>关系规范化<ul>
<li>规范化的程度，可以分为：<ul>
<li>1NF</li>
<li>2NF</li>
<li>3NF</li>
<li>BCNF,4NF,5NF</li>
</ul>
</li>
<li>满足高阶范式的关系模式一定满足低阶范式<ul>
<li>譬如满足3NF,则一定已经满足1NF及2NF</li>
<li>范式越高，规范化程度越好</li>
</ul>
</li>
</ul>
</li>
</ul>

        <h3 id="9-7-1NF和2NF"   >
          <a href="#9-7-1NF和2NF" class="heading-link"><i class="fas fa-link"></i></a><a href="#9-7-1NF和2NF" class="headerlink" title="9.7 1NF和2NF"></a>9.7 1NF和2NF</h3>
      
        <h4 id="1NF"   >
          <a href="#1NF" class="heading-link"><i class="fas fa-link"></i></a><a href="#1NF" class="headerlink" title="1NF"></a>1NF</h4>
      <p>定义：如果关系模式R中所有的属性都是基本属性，即每个属性都是不可再分的，则称R属于第一范式，简称1NF，记作R∈1NF</p>

        <h4 id="2NF"   >
          <a href="#2NF" class="heading-link"><i class="fas fa-link"></i></a><a href="#2NF" class="headerlink" title="2NF"></a>2NF</h4>
      <p>定义：如果关系模式R∈1NF，并且R中的每个非主属性都完全函数依赖于主码，则称R属于第二范式，简称2NF，记作R∈2NF</p>

        <h3 id="9-3-3NF"   >
          <a href="#9-3-3NF" class="heading-link"><i class="fas fa-link"></i></a><a href="#9-3-3NF" class="headerlink" title="9.3 3NF"></a>9.3 3NF</h3>
      <ul>
<li><p>如何使关系模式达到2NF，分解步骤共三步：</p>
<ol>
<li>将原关系模式主码属性集合的每一个子集作为主码分别构成相应的表。</li>
<li>将完全依赖于这些主码的属性放置到相应的表中</li>
<li>去掉只由原关系模式主码属性集的子集构成的表</li>
</ol>
</li>
<li><p>定义：如果关系模式R∈2NF，非主属性之间不存在函数依赖，则称R属于第三范式，简称3NF，记作R∈3NF</p>
</li>
<li><p>如何使关系模式达到3NF，分解步骤共三步：</p>
<ol>
<li>对于不是候选码的每个决定因子，从表中删去依赖于它的所有属性。</li>
<li>新建一个表，新标中包含该决定要因子以及原表中所有依赖于该决定因子的属性。</li>
<li>将决定因子作为新表的主码。</li>
</ol>
</li>
</ul>

        <h2 id="网课第十单元"   >
          <a href="#网课第十单元" class="heading-link"><i class="fas fa-link"></i></a><a href="#网课第十单元" class="headerlink" title="网课第十单元"></a>网课第十单元</h2>
      
        <h3 id="10-1-事务与并发控制"   >
          <a href="#10-1-事务与并发控制" class="heading-link"><i class="fas fa-link"></i></a><a href="#10-1-事务与并发控制" class="headerlink" title="10.1 事务与并发控制"></a>10.1 事务与并发控制</h3>
      <ul>
<li><p>事务的特性(ACID)</p>
<ul>
<li>原子性<ul>
<li>事务是一个完整的操作。事务的各步骤是不可分的；要么都执行，要么都不执行。</li>
</ul>
</li>
<li>一致性<ul>
<li>当事务完成时，数据必须处于一致状态。</li>
</ul>
</li>
<li>隔离性<ul>
<li>对数据进行修改的所有并发事物是彼此隔离的，这表明事物必须是独立的，它不应以任何方式依赖于或影响其他事务。</li>
</ul>
</li>
<li>永久性<ul>
<li>事务完成后，它对数据库的修改被永久保持，事务日志能够保持事务的永久性。</li>
</ul>
</li>
</ul>
</li>
<li><p>事务的分类</p>
<ul>
<li>显性事务<ul>
<li>用BEGIN TRANSACTION(TRAN)明确指定事务的开始，这是<strong>最常用的事物类型</strong></li>
</ul>
</li>
<li>隐性事务<ul>
<li>通过设置SET IMPLICIT_TRANSACTIONS ON语句，可启动阴性事务模式。当某个事务完成时，再下一个T-SQL语句又将启动一个新事务，隐性事务模式下，自动形成事务链。</li>
</ul>
</li>
<li>自动提交事务<ul>
<li>这是SQLServer的默认模式，它将每条单独的T-SQL语句视为一个事务，如果成功执行，则自动提交；如果错误，则自动回滚。</li>
</ul>
</li>
</ul>
</li>
<li><p>事务相关语句</p>
<ul>
<li>BEGIN Transaction<ul>
<li>标记事务开始，只是显示事务中使用</li>
</ul>
</li>
<li>COMMIT Transaction<ul>
<li>事务已经成功执行，数据已经处理妥当</li>
</ul>
</li>
<li>ROLLBACK Transaction<ul>
<li>数据处理过程中出错，回滚到没有处理之前的数据状态，或回滚到事务内部的保存点。</li>
</ul>
</li>
<li>SAVE Transaction<ul>
<li>事务内部设置的保存点，就是事务可以不全部回滚，只回滚到这里。</li>
</ul>
</li>
</ul>
</li>
<li><p>例子</p>
</li>
</ul>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span> tran updateAccount</span><br><span class="line">UPDATE bank <span class="keyword">SET</span> Money <span class="operator">=</span> Money<span class="number">-1000</span></span><br><span class="line"><span class="keyword">WHERE</span> name<span class="operator">=</span><span class="string">&#x27;A&#x27;</span></span><br><span class="line">SAVE tran before_update_2</span><br><span class="line">UPDATE bank <span class="keyword">SET</span> Money<span class="operator">=</span>Money<span class="operator">+</span><span class="number">1000</span></span><br><span class="line"><span class="keyword">WHERE</span> name<span class="operator">=</span><span class="string">&#x27;B&#x27;</span></span><br><span class="line">IF OK</span><br><span class="line">  <span class="keyword">COMMIT</span> tran updateAccount</span><br><span class="line"><span class="keyword">ELSE</span></span><br><span class="line">  <span class="keyword">ROLLBACK</span> tran updateAccount</span><br></pre></td></tr></table></div></figure>

<ul>
<li><p>丢失修改过程</p>
<ul>
<li>丢失修改是指事务1与事物2从数据库中读入同一数据并修改</li>
<li>事务2的提交结果破坏了事务1提交的结果导致事务1的修改被丢失</li>
</ul>
</li>
<li><p>读“脏”数据过程</p>
<ul>
<li>事务1修改某一数据，并将其写回磁盘</li>
<li>事务2读取同一数据后，事务1由于某种原因被撤销，这是事务1已修改过的数据恢复原值</li>
<li>事务2独到的数据就与数据库中的数据不一致，是不正确的数据，又称为“脏”数据</li>
</ul>
</li>
<li><p>不可重复读过程</p>
<ul>
<li>事务1读取某一数据后<ul>
<li>事务2对其做了修改，当事务1再次读取该数据时，得到与前一次不同的值。</li>
<li>事务2删除了其中部分记录，当事务1再次读取数据时，发现某些记录神秘的消失了！</li>
<li>事务2插入了一些记录，当事务1再次按相同条件读取数据时，发现多了一些记录。</li>
</ul>
</li>
<li>后两种不可重复读有时也称为幻影现象。</li>
</ul>
</li>
<li><p>并发控制措施</p>
<ul>
<li>当许多人试图同时修改数据库内的数据时，必须执行控制系统以使某个人所做的修改不会对其他人产生负面影响，这称为并发控制。</li>
<li>封锁(加锁)是实现并发控制的主要技术。</li>
</ul>
</li>
<li><p>封锁的定义</p>
<ul>
<li>事务T在堆某个数据对象(例如表、记录等)操作之前，先向系统发出请求，对其加锁。加锁后，事务T对该数据对象有了一定的控制，在事务T释放它的锁之前，其它的事务不能更新此数据对象。</li>
<li>一个事务对某个数据对象加锁后究竟拥有什么样的控制是由锁的类型决定的。</li>
</ul>
</li>
<li><p>封锁的类型</p>
<ul>
<li>基本封锁类型有两种<ul>
<li>排它锁(简记为x锁、写锁)<ul>
<li>若事务T对数据对象A加上X锁，则只允许T读取和修改A，其它任何事务都不能再对A加任何类型的锁，知道T释放A上的锁。</li>
</ul>
</li>
<li>共享锁(简记类s锁、读锁)<ul>
<li>若事务T对数据对象A加上S锁，则事务T可以读A但不能修改A，其它事务只能再对A加S锁，而不能加X锁，直到T释放A上的S锁</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>封锁协议</p>
<ul>
<li>在运用X锁和S锁对数据对象加锁时，需要约定一些规则，这些规则称为封锁协议<ul>
<li>何时申请X锁或S锁</li>
<li>持锁时间</li>
<li>何时释放</li>
</ul>
</li>
<li>对封锁方式规定不同的规则，就形成了各种不同的封锁协议<ul>
<li>一级封锁协议<ul>
<li>事务T在修改数据R之前不许先对其加X锁</li>
<li>可防止丢失修改，不能保证可重复读和不读“脏”数据。</li>
</ul>
</li>
<li>二级封锁协议<ul>
<li>事务T对要修改数据必须先加X锁，知道事务结束才释放X锁；</li>
<li>事务T在读取数据R之前必须先对其加S锁，读完后即可释放S锁</li>
<li>防止丢失修改和读“脏”数据，不能保证可重复读。</li>
</ul>
</li>
<li>三级封锁协议<ul>
<li>事务T在读取数据R之前必须先对其加S锁，在修改数据之前必须先加上X锁，知道事务结束才释放所有锁。</li>
<li>防止丢失修改、读脏数据和不可重复读。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>活锁是一种<strong>某个事务长期等待</strong>的现象</p>
</li>
<li><p>死锁是<strong>两个或两个以上</strong>的事务之间的<strong>循环等待</strong></p>
</li>
<li><p>解决活锁——先来先服务</p>
<ul>
<li>当多个事务请求封锁同一数据对象时，封锁子系统按请求封锁的先后次序对这些事务排队。该数据对象上的锁一旦释放，首先批准申请队列中第一个事务获得锁</li>
</ul>
</li>
<li><p>解决死锁的方法</p>
<ul>
<li>预防死锁发生<ul>
<li>一次封锁法<ul>
<li>要求每个事务必须一次将所有要使用的数据<strong>全部加锁</strong>，否则就不能继续执行；问题在于<strong>降低并发度</strong>。</li>
</ul>
</li>
<li>顺序封锁法<ul>
<li>预先对数据对象规定一个封锁顺序，<strong>所有事务都按这个顺序实行封锁</strong>。存在的问题<strong>难于实现</strong>。</li>
</ul>
</li>
</ul>
</li>
<li>允许发生，定期诊断，所有死锁则解锁<ul>
<li>超时法<ul>
<li>每个事务设定一个等待时限，如果等待时间超过了规定的时限，就认为发生了死锁。</li>
<li>优点：实现简单</li>
<li>缺点：有可能误判死锁</li>
</ul>
</li>
<li>等待图法<ul>
<li>周期性地检测事务等待图，如果发现图中存在回路，则表示系统中出现了死锁。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>死锁的解除</p>
<ul>
<li>选择一个或多个处于死锁状态的事务将其撤销，释放它们持有的锁，使其它事务能继续运行下去。</li>
<li>被撤销的事务对数据的修改必须加以恢复。</li>
<li>为了降低处理死锁的代价，通常选取处理死锁代价最小的事务。</li>
</ul>
</li>
<li><p>可串行化调度</p>
<ul>
<li>多个事务的并行执行是正确的，当且仅当其结果与<strong>按某一次序串行地执行</strong>它们时的<strong>结果相同</strong>，称这种调度策略为可串行化的调度。</li>
<li>可串行化是并发事物正确调度的准则。</li>
</ul>
</li>
<li><p>两端锁协议</p>
<ul>
<li>可串行性是并行调度正确性的唯一准则，两段锁(2PL)协议就是为保证并行调度可串行性而提供的封锁协议</li>
<li>两段锁协议的要求所有事务必须分两个阶段对数据项加锁和解锁<ul>
<li>在对任何数据进行读、写操作之前，事务首先要申请并获得对该数据的封锁。</li>
<li>在释放一个封锁之后，事务不再申请和获得任何其他封锁。</li>
</ul>
</li>
</ul>
</li>
<li><p>“两段”锁的含义事务分为两个阶段：</p>
<ul>
<li>第一阶段是获得封锁，也称为扩展阶段</li>
<li>第二阶段是释放封锁，也称为收缩阶段</li>
</ul>
</li>
<li><p>遵循两段锁协议是并发执行结果正确的充分条件而并非必要条件</p>
</li>
</ul>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ 本文结束，感谢您的阅读 ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">本文作者: </span><span class="copyright-author__value"><a href="http://blog.gddfeng.com">gddFeng</a></span></div><div class="copyright-link"><span class="copyright-link__name">本文链接: </span><span class="copyright-link__value"><a href="http://blog.gddfeng.com/notebooks-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/">http://blog.gddfeng.com/notebooks-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">版权声明: </span><span class="copyright-notice__value">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> 许可协议。转载请注明出处！</span></div></div><div class="post-tags"><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="http://blog.gddfeng.com/tags/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/">课堂笔记</a></span><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="http://blog.gddfeng.com/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/notebooks-c/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">C++</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/notebooks-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><span class="paginator-prev__text">计算机网络随堂笔记</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">文章目录</span><span class="sidebar-nav-ov">站点概览</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC1%E8%AF%BE-%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">
          第1课 介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.</span> <span class="toc-text">
          1.1 数据库结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1"><span class="toc-number">1.2.</span> <span class="toc-text">
          1.2 课程设计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-SQL-server%E4%BD%93%E9%AA%8C"><span class="toc-number">1.3.</span> <span class="toc-text">
          1.3 SQL server体验</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-1-%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7%E7%99%BB%E5%BD%95SQL-server"><span class="toc-number">1.3.1.</span> <span class="toc-text">
          1.3.1 使用工具登录SQL server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-2-%E4%BD%BF%E7%94%A8%E8%84%9A%E6%9C%AC"><span class="toc-number">1.3.2.</span> <span class="toc-text">
          1.3.2 使用脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-3-%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2%E5%92%8C%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.3.</span> <span class="toc-text">
          1.3.3 单表查询和多表查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.4.</span> <span class="toc-text">
          1.4 数据查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-1-SELECT%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.4.1.</span> <span class="toc-text">
          1.4.1 SELECT语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-2-%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%AD%E5%B8%B8%E7%94%A8%E8%BF%90%E7%AE%97%E7%AC%A6%E5%8F%B7"><span class="toc-number">1.4.2.</span> <span class="toc-text">
          1.4.2 条件表达式中常用运算符号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-3-%E5%B0%8F%E5%AE%9E%E8%B7%B5"><span class="toc-number">1.4.3.</span> <span class="toc-text">
          1.4.3 小实践</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BE%E5%90%8E%E6%95%B4%E7%90%86"><span class="toc-number">1.5.</span> <span class="toc-text">
          课后整理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8F%96%E6%B6%88%E5%8F%96%E5%80%BC%E9%87%8D%E5%A4%8D%E7%9A%84%E8%A1%8C"><span class="toc-number">1.5.1.</span> <span class="toc-text">
          1. 取消取值重复的行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-BETWENN-%E2%80%A6%E2%80%A6-AND-%E2%80%A6%E2%80%A6"><span class="toc-number">1.5.2.</span> <span class="toc-text">
          2.BETWENN …… AND ……</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%A1%AE%E5%AE%9A%E9%9B%86%E5%90%88IN"><span class="toc-number">1.5.3.</span> <span class="toc-text">
          3. 确定集合IN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%EF%BC%9A%E5%AD%97%E7%AC%A6%E5%8C%B9%E9%85%8DLIKE"><span class="toc-number">1.5.4.</span> <span class="toc-text">
          4. 模糊查询：字符匹配LIKE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E9%80%9A%E9%85%8D%E7%AC%A6"><span class="toc-number">1.5.5.</span> <span class="toc-text">
          5.通配符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E7%A9%BA%E5%80%BC%E6%9F%A5%E8%AF%A2%EF%BC%9AIS-NULL-IS-NOT-NULL"><span class="toc-number">1.5.6.</span> <span class="toc-text">
          6. 空值查询：IS NULL&#x2F;IS NOT NULL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-WHERE%E5%AD%90%E5%8F%A5%E4%B8%AD%E7%9A%84%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.5.7.</span> <span class="toc-text">
          7. WHERE子句中的逻辑运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5%E4%B8%AD%E7%9A%84%E6%8E%92%E5%BA%8F"><span class="toc-number">1.5.8.</span> <span class="toc-text">
          8. 查询语句中的排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E7%BB%9F%E8%AE%A1%E6%93%8D%E4%BD%9C"><span class="toc-number">1.5.9.</span> <span class="toc-text">
          9. 统计操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E5%AF%B9%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%E8%BF%9B%E8%A1%8C%E5%88%86%E7%BB%84"><span class="toc-number">1.5.10.</span> <span class="toc-text">
          10. 对查询结果进行分组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-group-by%E5%AD%90%E5%8F%A5%E4%B8%8Ewith-rollup%E9%80%89%E9%A1%B9"><span class="toc-number">1.5.11.</span> <span class="toc-text">
          11. group by子句与with rollup选项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E8%AF%BE%E5%86%85%E5%AE%B9"><span class="toc-number">1.6.</span> <span class="toc-text">
          网课内容</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC2%E8%AF%BE"><span class="toc-number">2.</span> <span class="toc-text">
          第2课</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A3%80%E7%B4%A2%E9%A1%BA%E5%BA%8F"><span class="toc-number">2.1.</span> <span class="toc-text">
          数据库检索顺序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%8C%87%E5%AE%9A%E7%9A%84%E5%88%97%E6%88%96%E5%85%A8%E9%83%A8%E5%88%97"><span class="toc-number">2.2.</span> <span class="toc-text">
          查询指定的列或全部列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E8%AF%BE"><span class="toc-number">2.3.</span> <span class="toc-text">
          网课</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8T-SQL%E8%AF%AD%E5%8F%A5%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">2.3.1.</span> <span class="toc-text">
          用T-SQL语句创建数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">2.3.2.</span> <span class="toc-text">
          删除数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C"><span class="toc-number">2.3.3.</span> <span class="toc-text">
          数据库的相关操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F"><span class="toc-number">2.3.4.</span> <span class="toc-text">
          完整性约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="toc-number">2.3.5.</span> <span class="toc-text">
          创建表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F%E5%90%8D"><span class="toc-number">2.3.6.</span> <span class="toc-text">
          完整性约束名</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC3%E8%AF%BE"><span class="toc-number">3.</span> <span class="toc-text">
          第3课</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#JOIN"><span class="toc-number">3.1.</span> <span class="toc-text">
          JOIN</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E8%AF%BE-1"><span class="toc-number">3.2.</span> <span class="toc-text">
          网课</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8T-SQL%E8%AF%AD%E5%8F%A5%E4%BF%AE%E6%94%B9%E8%A1%A8%E7%BB%93%E6%9E%84"><span class="toc-number">3.2.1.</span> <span class="toc-text">
          用T-SQL语句修改表结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E8%A1%A8"><span class="toc-number">3.2.2.</span> <span class="toc-text">
          删除数据表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%85%B3%E7%B3%BB%E5%9B%BE"><span class="toc-number">3.2.3.</span> <span class="toc-text">
          数据库关系图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AF%BC%E5%85%A5%E4%B8%8E%E5%AF%BC%E5%87%BA"><span class="toc-number">3.2.4.</span> <span class="toc-text">
          数据的导入与导出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="toc-number">3.2.5.</span> <span class="toc-text">
          常用字符串函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UPDATAE-lt-%E8%A1%A8%E5%90%8D-gt-SET-lt-%E5%88%97%E5%90%8D-gt"><span class="toc-number">3.2.6.</span> <span class="toc-text">
          UPDATAE &lt;表名&gt; SET &lt;列名&gt;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E8%BF%9E%E6%8E%A5"><span class="toc-number">3.2.7.</span> <span class="toc-text">
          内连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-number">3.2.8.</span> <span class="toc-text">
          外连接</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC4%E8%AF%BE"><span class="toc-number">4.</span> <span class="toc-text">
          第4课</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BE%E7%A8%8B%E5%9B%9E%E9%A1%BE"><span class="toc-number">4.1.</span> <span class="toc-text">
          课程回顾</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%9A%84%E6%95%99%E5%B8%88%E6%89%80%E6%9C%89%E4%BF%A1%E6%81%AF"><span class="toc-number">4.1.1.</span> <span class="toc-text">
          查询计算机系的教师所有信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E4%BF%A1%E7%AE%A1%E7%B3%BB%E7%9A%84%E6%89%80%E6%9C%89%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF"><span class="toc-number">4.1.2.</span> <span class="toc-text">
          查询信管系的所有学生信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A6%E5%A4%96%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.1.3.</span> <span class="toc-text">
          左外查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%89%80%E6%9C%89%E5%AD%A6%E7%94%9F%E7%9A%84%E5%AD%A6%E5%8F%B7%EF%BC%8C%E5%A7%93%E5%90%8D%EF%BC%8C%E8%AF%BE%E7%A8%8B%E7%BC%96%E5%8F%B7%EF%BC%8C%E6%88%90%E7%BB%A9"><span class="toc-number">4.1.4.</span> <span class="toc-text">
          查询所有学生的学号，姓名，课程编号，成绩</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E8%BD%AC%E6%8D%A2"><span class="toc-number">4.2.</span> <span class="toc-text">
          条件转换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.3.</span> <span class="toc-text">
          子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E7%9B%B8%E5%85%B3%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.3.1.</span> <span class="toc-text">
          不相关子查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%A4%E9%9B%86-intersect"><span class="toc-number">4.4.</span> <span class="toc-text">
          交集 intersect</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2%E7%9A%84%E8%B0%93%E8%AF%8D"><span class="toc-number">4.5.</span> <span class="toc-text">
          子查询的谓词</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%A6%E6%9C%89EXISIT"><span class="toc-number">4.6.</span> <span class="toc-text">
          带有EXISIT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E8%AF%BE-2"><span class="toc-number">4.7.</span> <span class="toc-text">
          网课</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B5%8C%E5%A5%97%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.7.1.</span> <span class="toc-text">
          嵌套查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E8%AF%BE-3"><span class="toc-number">4.8.</span> <span class="toc-text">
          网课</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE"><span class="toc-number">4.8.1.</span> <span class="toc-text">
          视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95"><span class="toc-number">4.8.2.</span> <span class="toc-text">
          索引</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%81%9A%E9%9B%86%E7%B4%A2%E5%BC%95"><span class="toc-number">4.8.2.1.</span> <span class="toc-text">
          聚集索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E8%81%9A%E9%9B%86%E7%B4%A2%E5%BC%95"><span class="toc-number">4.8.2.2.</span> <span class="toc-text">
          非聚集索引</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E5%8F%8A%E6%89%93%E5%8D%B0"><span class="toc-number">4.8.3.</span> <span class="toc-text">
          变量及打印</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.8.3.1.</span> <span class="toc-text">
          变量类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F"><span class="toc-number">4.8.3.2.</span> <span class="toc-text">
          声明局部变量</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F"><span class="toc-number">4.8.4.</span> <span class="toc-text">
          全局变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6-IF"><span class="toc-number">4.8.5.</span> <span class="toc-text">
          流程控制-IF</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#IF-EXISTS"><span class="toc-number">4.8.5.1.</span> <span class="toc-text">
          IF EXISTS</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6-CASE"><span class="toc-number">4.8.6.</span> <span class="toc-text">
          流程控制-CASE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6-WHILE"><span class="toc-number">4.8.7.</span> <span class="toc-text">
          流程控制-WHILE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E6%A6%82%E8%BF%B0"><span class="toc-number">4.8.8.</span> <span class="toc-text">
          存储过程概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E5%88%9B%E5%BB%BA%E5%92%8C%E6%89%A7%E8%A1%8C%E6%96%B9%E6%B3%95"><span class="toc-number">4.8.9.</span> <span class="toc-text">
          存储过程的创建和执行方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E8%AF%AD%E6%B3%95"><span class="toc-number">4.8.9.1.</span> <span class="toc-text">
          创建存储过程语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">4.8.9.2.</span> <span class="toc-text">
          执行存储过程</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E8%AF%BE"><span class="toc-number">5.</span> <span class="toc-text">
          第五课</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E8%AF%BE"><span class="toc-number">6.</span> <span class="toc-text">
          第六课</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E4%B9%A0"><span class="toc-number">6.1.</span> <span class="toc-text">
          复习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%A6%E6%9C%89EXISTS%E8%B0%93%E8%AF%8D%E7%9A%84%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.1.1.</span> <span class="toc-text">
          带有EXISTS谓词的子查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">6.2.</span> <span class="toc-text">
          数据类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E8%AF%BE-4"><span class="toc-number">6.3.</span> <span class="toc-text">
          网课</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0-%E6%A0%87%E9%87%8F%E5%87%BD%E6%95%B0"><span class="toc-number">6.3.1.</span> <span class="toc-text">
          自定义函数-标量函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%87%E9%87%8F%E5%87%BD%E6%95%B0%E5%88%9B%E5%BB%BA%E7%9A%84%E8%AF%AD%E6%B3%95"><span class="toc-number">6.3.1.1.</span> <span class="toc-text">
          标量函数创建的语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%86%85%E5%B5%8C%E8%A1%A8%E5%80%BC%E5%87%BD%E6%95%B0"><span class="toc-number">6.3.1.2.</span> <span class="toc-text">
          创建内嵌表值函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">6.3.2.</span> <span class="toc-text">
          触发器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-number">6.3.2.1.</span> <span class="toc-text">
          触发器的概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">6.3.2.2.</span> <span class="toc-text">
          后触发器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">6.3.2.3.</span> <span class="toc-text">
          前触发器</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86"><span class="toc-number">6.3.3.</span> <span class="toc-text">
          安全管理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E8%AF%BE-5"><span class="toc-number">6.4.</span> <span class="toc-text">
          网课</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%87%E4%BB%BD%E5%92%8C%E6%81%A2%E5%A4%8D%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">6.4.1.</span> <span class="toc-text">
          备份和恢复数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%95%85%E9%9A%9C"><span class="toc-number">6.4.1.1.</span> <span class="toc-text">
          数据故障</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%87%E4%BB%BD%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">6.4.1.2.</span> <span class="toc-text">
          备份数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%87%E4%BB%BD%E7%AD%96%E7%95%A5"><span class="toc-number">6.4.1.3.</span> <span class="toc-text">
          备份策略</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Server%E7%9A%84%E5%A4%87%E4%BB%BD%E6%9C%BA%E5%88%B6"><span class="toc-number">6.4.1.4.</span> <span class="toc-text">
          SQL Server的备份机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%81%A2%E5%A4%8D%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">6.4.1.5.</span> <span class="toc-text">
          恢复数据库</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E8%AF%BE%E7%AC%AC%E4%B9%9D%E5%8D%95%E5%85%83"><span class="toc-number">6.5.</span> <span class="toc-text">
          网课第九单元</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B"><span class="toc-number">6.5.1.</span> <span class="toc-text">
          9.1 数据模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-%E8%81%94%E7%B3%BB"><span class="toc-number">6.5.2.</span> <span class="toc-text">
          9.2 联系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-%E5%A4%9A%E5%AF%B9%E5%A4%9A"><span class="toc-number">6.5.3.</span> <span class="toc-text">
          9.3 多对多</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">6.5.4.</span> <span class="toc-text">
          9.4 关系数据库的基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-5-%E5%87%BD%E6%95%B0%E4%BE%9D%E8%B5%96"><span class="toc-number">6.5.5.</span> <span class="toc-text">
          9.5 函数依赖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-6-%E5%85%B3%E7%B3%BB%E8%A7%84%E8%8C%83%E5%8C%96"><span class="toc-number">6.5.6.</span> <span class="toc-text">
          9.6 关系规范化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-7-1NF%E5%92%8C2NF"><span class="toc-number">6.5.7.</span> <span class="toc-text">
          9.7 1NF和2NF</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1NF"><span class="toc-number">6.5.7.1.</span> <span class="toc-text">
          1NF</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2NF"><span class="toc-number">6.5.7.2.</span> <span class="toc-text">
          2NF</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-3NF"><span class="toc-number">6.5.8.</span> <span class="toc-text">
          9.3 3NF</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E8%AF%BE%E7%AC%AC%E5%8D%81%E5%8D%95%E5%85%83"><span class="toc-number">6.6.</span> <span class="toc-text">
          网课第十单元</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-%E4%BA%8B%E5%8A%A1%E4%B8%8E%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6"><span class="toc-number">6.6.1.</span> <span class="toc-text">
          10.1 事务与并发控制</span></a></li></ol></li></ol></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/stun-logo.svg" alt="avatar"></div><p class="sidebar-ov-author__text">gddFeng</p></div><div class="sidebar-ov-social"><a class="sidebar-ov-social-item" href="http://wpa.qq.com/msgrd?v=3&amp;uin=2418180738&amp;site=qq&amp;menu=yes" target="_blank" rel="noopener" data-popover="QQ" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-qq"></i></span></a></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">41</div><div class="sidebar-ov-state-item__name">归档</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">10</div><div class="sidebar-ov-state-item__name">分类</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="知识共享许可协议" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">你已阅读了 </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2021~2022</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>gddFeng All Rights Reserved</span><span class="footer__devider">|</span><span>冀2021001072号</span></div><div>有英勇也有温柔。</div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><div class="search-mask"></div><div class="search-popup"><span class="search-close"></span><div class="search-input"><input placeholder="搜索文章（支持多关键词，请用空格分隔）"></div><div class="search-results"></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script>function initSearch() {
  var isXML = true;
  var search_path = 'search.json';

  if (!search_path) {
    search_path = 'search.xml';
  } else if (/json$/i.test(search_path)) {
    isXML = false;
  }

  var path = '/' + search_path;
  $.ajax({
    url: path,
    dataType: isXML ? 'xml' : 'json',
    async: true,
    success: function (res) {
      var datas = isXML ? $('entry', res).map(function () {
        // 将 XML 转为 JSON
        return {
          title: $('title', this).text(),
          content: $('content', this).text(),
          url: $('url', this).text()
        };
      }).get() : res;
      var $input = $('.search-input input');
      var $result = $('.search-results');
      // 搜索对象（标题、内容）的权重，影响显示顺序
      var WEIGHT = { title: 100, content: 1 };
      var searchPost = function () {
        var searchText = $input.val().toLowerCase().trim();
        // 根据空白字符分隔关键字
        var keywords = searchText.split(/[\s]+/);
        // 搜索结果
        var matchPosts = [];

        // 有多个关键字时，将原文字整个保存下来
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        // 防止未输入字符时搜索
        if (searchText.length > 0) {
          datas.forEach(function (data) {
            var isMatch  = false;
            // 没有标题的文章使用预设的 i18n 变量代替
            var title = (data.title && data.title.trim()) || '[ 文章无标题 ]';
            var titleLower = title && title.toLowerCase();
            // 删除 HTML 标签 和 所有空白字符
            var content = data.content && data.content.replace(/<[^>]+>/g, '');
            var contentLower = content && content.toLowerCase();
            // 删除重复的 /
            var postURL = data.url && decodeURI(data.url).replace(/\/{2,}/g, '/');
            // 标题中匹配到的关键词
            var titleHitSlice = [];
            // 内容中匹配到的关键词
            var contentHitSlice = [];

            keywords.forEach(function (keyword) {
              /**
              * 获取匹配的关键词的索引
              * @param {String} keyword 要匹配的关键字
              * @param {String} text 原文字
              * @param {Boolean} caseSensitive 是否区分大小写
              * @param {Number} weight 匹配对象的权重。权重大的优先显示
              * @return {Array}
              */
              function getIndexByword (word, text, caseSensitive, weight) {
                if (!word || !text) {
                  return [];
                };

                var startIndex = 0; // 每次匹配的开始索引
                var index = -1;     // 匹配到的索引值
                var result = [];    // 匹配结果

                if (!caseSensitive) {
                  word = word.toLowerCase();
                  text = text.toLowerCase();
                }

                while((index = text.indexOf(word, startIndex)) !== -1) {
                  var hasMatch = false;
                  // 索引位置相同的关键词，保留长度较长的
                  titleHitSlice.forEach(function (hit) {
                    if (hit.index === index && hit.word.length < word.length) {
                      hit.word = word;
                      hasMatch = true;
                    }
                  });
                  startIndex = index + word.length;
                  !hasMatch && result.push({ index: index, word: word, weight: weight });
                }
                return result;
              }
              titleHitSlice = titleHitSlice.concat(getIndexByword(keyword, titleLower, false, WEIGHT.title));
              contentHitSlice = contentHitSlice.concat(getIndexByword(keyword, contentLower, false, WEIGHT.content));
            });

            var hitTitle = titleHitSlice.length;
            var hitContent = contentHitSlice.length;

            if (hitTitle > 0 || hitContent > 0) {
              isMatch = true;
            }
            if (isMatch) {
              ;[titleHitSlice, contentHitSlice].forEach(function (hit) {
                // 按照匹配文字的索引的递增顺序排序
                hit.sort(function (left, right) {
                  return left.index - right.index;
                });
              });
              /**
              * 给文本中匹配到的关键词添加标记，从而进行高亮显示
              * @param {String} text 原文本
              * @param {Array} hitSlice 匹配项的索引信息
              * @param {Number} start 开始索引
              * @param {Number} end 结束索引
              * @return {String}
              */
              function highlightKeyword (text, hitSlice, start, end) {
                if (!text || !hitSlice || !hitSlice.length) {
                  return;
                }

                var result = '';
                var startIndex = start;
                var endIndex = end;
                hitSlice.forEach(function (hit) {
                  if (hit.index < startIndex) {
                    return;
                  }

                  var hitWordEnd = hit.index + hit.word.length;
                  result += text.slice(startIndex, hit.index);
                  result += '<b>' + text.slice(hit.index, hitWordEnd) + '</b>';
                  startIndex = hitWordEnd;
                });
                result += text.slice(startIndex, endIndex);
                return result;
              }

              var postData = {};
              // 文章总的搜索权重
              var postWeight = titleHitSlice.length * WEIGHT.title + contentHitSlice.length * WEIGHT.content;
              // 标记匹配关键词后的标题
              var postTitle = highlightKeyword(title, titleHitSlice, 0, title.length) || title;
              // 标记匹配关键词后的内容
              var postContent;
              // 显示内容的长度
              var SHOW_WORD_LENGTH = 200;
              // 命中关键词前的字符显示长度
              var SHOW_WORD_FRONT_LENGTH = 20;
              var SHOW_WORD_END_LENGTH = SHOW_WORD_LENGTH - SHOW_WORD_FRONT_LENGTH;

              // 截取匹配的第一个字符，前后共 200 个字符来显示
              if (contentHitSlice.length > 0) {
                var firstIndex = contentHitSlice[0].index;
                var start = firstIndex > SHOW_WORD_FRONT_LENGTH ? firstIndex - SHOW_WORD_FRONT_LENGTH : 0;
                var end = firstIndex + SHOW_WORD_END_LENGTH;
                postContent = highlightKeyword(content, contentHitSlice, start, end);
              } else { // 未匹配到内容，直接截取前 200 个字符来显示
                postContent = content.slice(0, SHOW_WORD_LENGTH);
              }
              postData.title = postTitle;
              postData.content = postContent;
              postData.url = postURL;
              postData.weight = postWeight;
              matchPosts.push(postData);
            }
          });
        }

        var resultInnerHtml = '';
        if (matchPosts.length) {
          // 按权重递增的顺序排序，使权重大的优先显示
          matchPosts.sort(function (left, right) {
            return right.weight - left.weight;
          });
          resultInnerHtml += '<ul>';
          matchPosts.forEach(function (post) {
            resultInnerHtml += '<li><a class="search-results-title" href="' + post.url + '">';
            resultInnerHtml += post.title;
            resultInnerHtml += '</a><div class="search-results-content">';
            resultInnerHtml += post.content;
            resultInnerHtml += '</div></li>';
          });
          resultInnerHtml += '</ul>';
        } else {
          resultInnerHtml += '<div class="search-results-none"><i class="far fa-meh"></i></div>';
        }
        $result.html(resultInnerHtml);
      };
      $input.on('input', searchPost);
      $input.on('keyup', function (e) {
        if (e.keyCode === Stun.utils.codeToKeyCode('Enter')) {
          searchPost();
        }
      });
    }
  });
}

function closeSearch () {
  $('body').css({ overflow: 'auto' });
  $('.search-popup').css({ display: 'none' });
  $('.search-mask').css({ display: 'none' });
}

window.addEventListener('DOMContentLoaded', function () {
  Stun.utils.pjaxReloadLocalSearch = function () {
    $('.header-nav-search').on('click', function (e) {
      e.stopPropagation();
      $('body').css('overflow', 'hidden');
      $('.search-popup')
        .velocity('stop')
        .velocity('transition.expandIn', {
          duration: 300,
          complete: function () {
            $('.search-popup input').focus();
          }
        });
      $('.search-mask')
        .velocity('stop')
        .velocity('transition.fadeIn', {
          duration: 300
        });

      initSearch();
    });
    $('.search-mask, .search-close').on('click', function () {
      closeSearch();
    });
    $(document).on('keydown', function (e) {
      // Escape <=> 27
      if (e.keyCode === Stun.utils.codeToKeyCode('Escape')) {
        closeSearch();
      }
    });
  };

  Stun.utils.pjaxReloadLocalSearch();
}, false);

function safeOpenUrl(url) {
  var newTab = window.open();
  newTab.opener = null;
  newTab.location = url;
}

function extSearch(engine) {
  var engines = {
    google: 'https://www.google.com/search?q=',
    bing: 'https://cn.bing.com/search?q=',
    baidu: 'https://www.baidu.com/s?ie=UTF-8&wd=',
  };
  var host = window.location.host;
  var query = $('.search-input input').val().toLowerCase().trim();
  var uri = engines[engine] + query + ' site:' + host;

  if (query) {
    safeOpenUrl(uri);
  } else {
    Stun.utils.popAlert('warning', '请输入字符');
  }
}

var assistSearchList = window.CONFIG.assistSearch;

if (Array.isArray(assistSearchList)) {
  assistSearchList.forEach(function (name) {
    document.querySelector('.search-btns-item--' + name).addEventListener('click', function () {
      extSearch(name);
    }, false);
  });
}</script><script src="/js/utils.js?v=2.6.2"></script><script src="/js/stun-boot.js?v=2.6.2"></script><script src="/js/scroll.js?v=2.6.2"></script><script src="/js/header.js?v=2.6.2"></script><script src="/js/sidebar.js?v=2.6.2"></script><script type="application/json" src="/search.json"></script></body></html>